<!DOCTYPE html><html lang="zh-CN" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="天前"><meta name="hour-prompt" content="小时前"><meta name="minute-prompt" content="分钟前"><meta name="justnow-prompt" content="刚刚"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="MyBatis" /><meta property="og:locale" content="zh_CN" /><meta name="description" content="Mybatis简介" /><meta property="og:description" content="Mybatis简介" /><link rel="canonical" href="https://casflawed.github.io/posts/MyBatis/" /><meta property="og:url" content="https://casflawed.github.io/posts/MyBatis/" /><meta property="og:site_name" content="flameking" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-07-12T00:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="MyBatis" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"mainEntityOfPage":{"@type":"WebPage","@id":"https://casflawed.github.io/posts/MyBatis/"},"description":"Mybatis简介","url":"https://casflawed.github.io/posts/MyBatis/","@type":"BlogPosting","headline":"MyBatis","dateModified":"2022-11-17T17:39:28+08:00","datePublished":"2022-07-12T00:00:00+08:00","@context":"https://schema.org"}</script><title>MyBatis | flameking</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="flameking"><meta name="application-name" content="flameking"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="zh-CN"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://cdn.jsdelivr.net/gh/Casflawed/img-host@master/blog/202201120016998.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">flameking</a></div><div class="site-subtitle font-italic">Life is flawed,but we still love life</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>首页</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>分类</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>标签</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>归档</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>关于</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/Casflawed" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['2711554770','qq.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> 首页 </a> </span> <span>MyBatis</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> 文章</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="搜索..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >取消</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>MyBatis</h1><div class="post-meta text-muted"><div> 作者 <em> <a href="https://github.com/Casflawed">flameking</a> </em></div><div class="d-flex"><div> <span> 发表于 <em class="timeago" date="2022-07-12 00:00:00 +0800" data-toggle="tooltip" data-placement="bottom" title="2022-07-12, 00:00 +0800" >2022-07-12</em> </span> <span> 更新于 <em class="timeago" date="2022-11-17 17:39:28 +0800 " data-toggle="tooltip" data-placement="bottom" title="2022-11-17, 17:39 +0800" >2022-11-17</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="11012 字"> <em>61 分钟</em>阅读</span></div></div></div><div class="post-content"><h1 id="mybatis简介">Mybatis简介</h1><h2 id="mybatis历史">MyBatis历史<a href="#mybatis历史" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>MyBatis最初是Apache的一个开源项目iBatis, 2010年6月这个项目由Apache Software Foundation迁移到了Google Code。随着开发团队转投Google Code旗下，iBatis3.x正式更名为MyBatis。代码于2013年11月迁移到Github</p><p>iBatis一词来源于“internet”和“abatis”的组合，是一个基于Java的持久层框架。iBatis提供的持久层框架包括SQL Maps和Data Access Objects（DAO）</p><h2 id="mybatis特性">MyBatis特性<a href="#mybatis特性" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>MyBatis 是支持定制化 SQL、存储过程以及高级映射的优秀的持久层框架<li>MyBatis 避免了几乎所有的 JDBC 代码和手动设置参数以及获取结果集<li>MyBatis可以使用简单的XML或注解用于配置和原始映射，将接口和Java的POJO（Plain Old Java Objects，普通的Java对象）映射成数据库中的记录<li>MyBatis 是一个半自动的ORM（Object Relation Mapping）框架</ol><h2 id="mybatis下载">MyBatis下载<a href="#mybatis下载" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li><a href="https://github.com/mybatis/mybatis-3">MyBatis下载地址</a><li><img data-src="https://cdn.jsdelivr.net/gh/Casflawed/img-host@master/blog/202207131303464.png" alt="MyBatis下载" data-proofer-ignore></ul><h2 id="和其它持久化层技术对比">和其它持久化层技术对比<a href="#和其它持久化层技术对比" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>JDBC<ul><li>SQL 夹杂在Java代码中耦合度高，导致硬编码内伤<li>维护不易且实际开发需求中 SQL 有变化，频繁修改的情况多见<li>代码冗长，开发效率低</ul><li>Hibernate 和 JPA<ul><li>操作简便，开发效率高<li>程序中的长难复杂 SQL 需要绕过框架<li>内部自动生产的 SQL，不容易做特殊优化<li>基于全映射的全自动框架，大量字段的 POJO 进行部分映射时比较困难。<li>反射操作太多，导致数据库性能下降</ul><li>MyBatis<ul><li>轻量级，性能出色<li>SQL 和 Java 编码分开，功能边界清晰。Java代码专注业务、SQL语句专注数据<li>开发效率稍逊于HIbernate，但是完全能够接受</ul></ul><h1 id="搭建mybatis">搭建MyBatis</h1><h2 id="开发环境">开发环境<a href="#开发环境" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>IDE：idea 2019.2<li>构建工具：maven 3.5.4<li>MySQL版本：MySQL 5.7<li>MyBatis版本：MyBatis 3.5.7</ul><h2 id="创建maven工程">创建maven工程<a href="#创建maven工程" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>打包方式：jar<li>引入依赖</ul><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="nt">&lt;dependencies&gt;</span>
	<span class="c">&lt;!-- Mybatis核心 --&gt;</span>
	<span class="nt">&lt;dependency&gt;</span>
		<span class="nt">&lt;groupId&gt;</span>org.mybatis<span class="nt">&lt;/groupId&gt;</span>
		<span class="nt">&lt;artifactId&gt;</span>mybatis<span class="nt">&lt;/artifactId&gt;</span>
		<span class="nt">&lt;version&gt;</span>3.5.7<span class="nt">&lt;/version&gt;</span>
	<span class="nt">&lt;/dependency&gt;</span>
	<span class="c">&lt;!-- junit测试 --&gt;</span>
	<span class="nt">&lt;dependency&gt;</span>
		<span class="nt">&lt;groupId&gt;</span>junit<span class="nt">&lt;/groupId&gt;</span>
		<span class="nt">&lt;artifactId&gt;</span>junit<span class="nt">&lt;/artifactId&gt;</span>
		<span class="nt">&lt;version&gt;</span>4.12<span class="nt">&lt;/version&gt;</span>
		<span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
	<span class="nt">&lt;/dependency&gt;</span>
	<span class="c">&lt;!-- MySQL驱动 --&gt;</span>
	<span class="nt">&lt;dependency&gt;</span>
		<span class="nt">&lt;groupId&gt;</span>mysql<span class="nt">&lt;/groupId&gt;</span>
		<span class="nt">&lt;artifactId&gt;</span>mysql-connector-java<span class="nt">&lt;/artifactId&gt;</span>
		<span class="nt">&lt;version&gt;</span>5.1.3<span class="nt">&lt;/version&gt;</span>
		<span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;/dependencies&gt;</span>
</pre></table></code></div></div><h2 id="创建mybatis的核心配置文件">创建MyBatis的核心配置文件<a href="#创建mybatis的核心配置文件" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><blockquote><p>习惯上命名为<code class="language-plaintext highlighter-rouge">mybatis-config.xml</code>，这个文件名仅仅只是建议，并非强制要求。将来整合Spring之后，这个配置文件可以省略，所以大家操作时可以直接复制、粘贴。 核心配置文件主要用于配置连接数据库的环境以及MyBatis的全局配置信息 核心配置文件存放的位置是src/main/resources目录下</p></blockquote><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>  
<span class="cp">&lt;!DOCTYPE configuration  
PUBLIC "-//mybatis.org//DTD Config 3.0//EN"  
"http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;</span>  
<span class="nt">&lt;configuration&gt;</span>
	<span class="c">&lt;!--设置连接数据库的环境--&gt;</span>  
	<span class="nt">&lt;environments</span> <span class="na">default=</span><span class="s">"development"</span><span class="nt">&gt;</span>  
		<span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">"development"</span><span class="nt">&gt;</span>  
			<span class="nt">&lt;transactionManager</span> <span class="na">type=</span><span class="s">"JDBC"</span><span class="nt">/&gt;</span>  
			<span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">"POOLED"</span><span class="nt">&gt;</span>  
				<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"driver"</span> <span class="na">value=</span><span class="s">"com.mysql.cj.jdbc.Driver"</span><span class="nt">/&gt;</span>  
				<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"url"</span> <span class="na">value=</span><span class="s">"jdbc:mysql://localhost:3306/MyBatis"</span><span class="nt">/&gt;</span>  
				<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"username"</span> <span class="na">value=</span><span class="s">"root"</span><span class="nt">/&gt;</span>  
				<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"password"</span> <span class="na">value=</span><span class="s">"123456"</span><span class="nt">/&gt;</span>  
			<span class="nt">&lt;/dataSource&gt;</span>  
		<span class="nt">&lt;/environment&gt;</span>  
	<span class="nt">&lt;/environments&gt;</span>  
	<span class="c">&lt;!--引入映射文件--&gt;</span>  
	<span class="nt">&lt;mappers&gt;</span>  
		<span class="nt">&lt;mapper</span> <span class="na">resource=</span><span class="s">"mappers/UserMapper.xml"</span><span class="nt">/&gt;</span>  
	<span class="nt">&lt;/mappers&gt;</span>  
<span class="nt">&lt;/configuration&gt;</span>
</pre></table></code></div></div><h2 id="创建mapper接口">创建mapper接口<a href="#创建mapper接口" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><blockquote><p>MyBatis中的mapper接口相当于以前的dao。但是区别在于，mapper仅仅是接口，我们不需要提供实现类</p></blockquote><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">com.atguigu.mybatis.mapper</span><span class="o">;</span>  
  
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserMapper</span> <span class="o">{</span>  
	<span class="cm">/**  
	* 添加用户信息  
	*/</span>  
	<span class="kt">int</span> <span class="nf">insertUser</span><span class="o">();</span>  
<span class="o">}</span>
</pre></table></code></div></div><h2 id="创建mybatis的映射文件">创建MyBatis的映射文件<a href="#创建mybatis的映射文件" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>相关概念：ORM（Object Relationship Mapping）对象关系映射。<ul><li>对象：Java的实体类对象<li>关系：关系型数据库<li>映射：二者之间的对应关系</ul></ul><div class="table-wrapper"><table><thead><tr><th>Java概念<th>数据库概念<tbody><tr><td>类<td>表<tr><td>属性<td>字段/列<tr><td>对象<td>记录/行</table></div><ul><li>映射文件的命名规则<ul><li>表所对应的实体类的类名+Mapper.xml<li>例如：表t_user，映射的实体类为User，所对应的映射文件为UserMapper.xml<li>因此一个映射文件对应一个实体类，对应一张表的操作<li>MyBatis映射文件用于编写SQL，访问以及操作表中的数据<li>MyBatis映射文件存放的位置是src/main/resources/mappers目录下</ul><li>MyBatis中可以面向接口操作数据，要保证两个一致<ul><li>mapper接口的全类名和映射文件的命名空间（namespace）保持一致<li>mapper接口中方法的方法名和映射文件中编写SQL的标签的id属性保持一致</ul></ul><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>  
<span class="cp">&lt;!DOCTYPE mapper  
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  
"http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</span>  
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">"com.atguigu.mybatis.mapper.UserMapper"</span><span class="nt">&gt;</span>  
	<span class="c">&lt;!--int insertUser();--&gt;</span>  
	<span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">"insertUser"</span><span class="nt">&gt;</span>  
		insert into t_user values(null,'张三','123',23,'女')  
	<span class="nt">&lt;/insert&gt;</span>  
<span class="nt">&lt;/mapper&gt;</span>
</pre></table></code></div></div><h2 id="通过junit测试功能">通过junit测试功能<a href="#通过junit测试功能" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>SqlSession：代表Java程序和数据库之间的会话。（HttpSession是Java程序和浏览器之间的会话）<li>SqlSessionFactory：是“生产”SqlSession的“工厂”<li>工厂模式：如果创建某一个对象，使用的过程基本固定，那么我们就可以把创建这个对象的相关代码封装到一个“工厂类”中，以后都使用这个工厂类来“生产”我们需要的对象</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserMapperTest</span> <span class="o">{</span>
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testInsertUser</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="c1">//读取MyBatis的核心配置文件</span>
        <span class="nc">InputStream</span> <span class="n">is</span> <span class="o">=</span> <span class="nc">Resources</span><span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="s">"mybatis-config.xml"</span><span class="o">);</span>
        <span class="c1">//获取SqlSessionFactoryBuilder对象</span>
        <span class="nc">SqlSessionFactoryBuilder</span> <span class="n">sqlSessionFactoryBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SqlSessionFactoryBuilder</span><span class="o">();</span>
        <span class="c1">//通过核心配置文件所对应的字节输入流创建工厂类SqlSessionFactory，生产SqlSession对象</span>
        <span class="nc">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span> <span class="o">=</span> <span class="n">sqlSessionFactoryBuilder</span><span class="o">.</span><span class="na">build</span><span class="o">(</span><span class="n">is</span><span class="o">);</span>
        <span class="c1">//获取sqlSession，此时通过SqlSession对象所操作的sql都必须手动提交或回滚事务</span>
        <span class="c1">//SqlSession sqlSession = sqlSessionFactory.openSession();</span>
	    <span class="c1">//创建SqlSession对象，此时通过SqlSession对象所操作的sql都会自动提交  </span>
		<span class="nc">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
        <span class="c1">//通过代理模式创建UserMapper接口的代理实现类对象</span>
        <span class="nc">UserMapper</span> <span class="n">userMapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="nc">UserMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="c1">//调用UserMapper接口中的方法，就可以根据UserMapper的全类名匹配元素文件，通过调用的方法名匹配映射文件中的SQL标签，并执行标签中的SQL语句</span>
        <span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="n">userMapper</span><span class="o">.</span><span class="na">insertUser</span><span class="o">();</span>
        <span class="c1">//提交事务</span>
        <span class="c1">//sqlSession.commit();</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"result:"</span> <span class="o">+</span> <span class="n">result</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><ul><li>此时需要手动提交事务，如果要自动提交事务，则在获取sqlSession对象时，使用<code class="language-plaintext highlighter-rouge">SqlSession sqlSession = sqlSessionFactory.openSession(true);</code>，传入一个Boolean类型的参数，值为true，这样就可以自动提交</ul><h2 id="加入log4j日志功能">加入log4j日志功能<a href="#加入log4j日志功能" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>1.加入依赖</p><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c">&lt;!-- log4j日志 --&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
<span class="nt">&lt;groupId&gt;</span>log4j<span class="nt">&lt;/groupId&gt;</span>
<span class="nt">&lt;artifactId&gt;</span>log4j<span class="nt">&lt;/artifactId&gt;</span>
<span class="nt">&lt;version&gt;</span>1.2.17<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></table></code></div></div><p>2.加入log4j的配置文件</p><p>log4j的配置文件名为log4j.xml，存放的位置是src/main/resources目录下<br /> 日志的级别：FATAL(致命) &gt; ERROR(错误) &gt; WARN(警告) &gt; INFO(信息) &gt; DEBUG(调试) 从左到右打印的内容越来越详细</p><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="cp">&lt;!DOCTYPE log4j:configuration SYSTEM "log4j.dtd"&gt;</span>
<span class="nt">&lt;log4j:configuration</span> <span class="na">xmlns:log4j=</span><span class="s">"http://jakarta.apache.org/log4j/"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;appender</span> <span class="na">name=</span><span class="s">"STDOUT"</span> <span class="na">class=</span><span class="s">"org.apache.log4j.ConsoleAppender"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"Encoding"</span> <span class="na">value=</span><span class="s">"UTF-8"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;layout</span> <span class="na">class=</span><span class="s">"org.apache.log4j.PatternLayout"</span><span class="nt">&gt;</span>
			<span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"ConversionPattern"</span> <span class="na">value=</span><span class="s">"%-5p %d{MM-dd HH:mm:ss,SSS} %m (%F:%L) \n"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/layout&gt;</span>
    <span class="nt">&lt;/appender&gt;</span>
    <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">"java.sql"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;level</span> <span class="na">value=</span><span class="s">"debug"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/logger&gt;</span>
    <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">"org.apache.ibatis"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;level</span> <span class="na">value=</span><span class="s">"info"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/logger&gt;</span>
    <span class="nt">&lt;root&gt;</span>
        <span class="nt">&lt;level</span> <span class="na">value=</span><span class="s">"debug"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"STDOUT"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/root&gt;</span>
<span class="nt">&lt;/log4j:configuration&gt;</span>
</pre></table></code></div></div><h1 id="核心配置文件详解">核心配置文件详解</h1><blockquote><p>核心配置文件中的标签必须按照固定的顺序(有的标签可以不写，但顺序一定不能乱)： properties、settings、typeAliases、typeHandlers、objectFactory、objectWrapperFactory、reflectorFactory、plugins、environments、databaseIdProvider、mappers</p></blockquote><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
</pre><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="cp">&lt;!DOCTYPE configuration
        PUBLIC "-//MyBatis.org//DTD Config 3.0//EN"
        "http://MyBatis.org/dtd/MyBatis-3-config.dtd"&gt;</span>
<span class="nt">&lt;configuration&gt;</span>
    <span class="c">&lt;!--引入properties文件，此时就可以${属性名}的方式访问属性值--&gt;</span>
    <span class="nt">&lt;properties</span> <span class="na">resource=</span><span class="s">"jdbc.properties"</span><span class="nt">&gt;&lt;/properties&gt;</span>
    <span class="nt">&lt;settings&gt;</span>
        <span class="c">&lt;!--将表中字段的下划线自动转换为驼峰--&gt;</span>
        <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"mapUnderscoreToCamelCase"</span> <span class="na">value=</span><span class="s">"true"</span><span class="nt">/&gt;</span>
        <span class="c">&lt;!--开启延迟加载--&gt;</span>
        <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"lazyLoadingEnabled"</span> <span class="na">value=</span><span class="s">"true"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/settings&gt;</span>
    <span class="nt">&lt;typeAliases&gt;</span>
        <span class="c">&lt;!--
        typeAlias：设置某个具体的类型的别名
        属性：
        type：需要设置别名的类型的全类名
        alias：设置此类型的别名，且别名不区分大小写。若不设置此属性，该类型拥有默认的别名，即类名
        --&gt;</span>
        <span class="c">&lt;!--&lt;typeAlias type="com.atguigu.mybatis.bean.User"&gt;&lt;/typeAlias&gt;--&gt;</span>
        <span class="c">&lt;!--&lt;typeAlias type="com.atguigu.mybatis.bean.User" alias="user"&gt;
        &lt;/typeAlias&gt;--&gt;</span>
        <span class="c">&lt;!--以包为单位，设置改包下所有的类型都拥有默认的别名，即类名且不区分大小写--&gt;</span>
        <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">"com.atguigu.mybatis.bean"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/typeAliases&gt;</span>
    <span class="c">&lt;!--
    environments：设置多个连接数据库的环境
    属性：
	    default：设置默认使用的环境的id
    --&gt;</span>
    <span class="nt">&lt;environments</span> <span class="na">default=</span><span class="s">"mysql_test"</span><span class="nt">&gt;</span>
        <span class="c">&lt;!--
        environment：设置具体的连接数据库的环境信息
        属性：
	        id：设置环境的唯一标识，可通过environments标签中的default设置某一个环境的id，表示默认使用的环境
        --&gt;</span>
        <span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">"mysql_test"</span><span class="nt">&gt;</span>
            <span class="c">&lt;!--
            transactionManager：设置事务管理方式
            属性：
	            type：设置事务管理方式，type="JDBC|MANAGED"
	            type="JDBC"：设置当前环境的事务管理都必须手动处理
	            type="MANAGED"：设置事务被管理，例如spring中的AOP
            --&gt;</span>
            <span class="nt">&lt;transactionManager</span> <span class="na">type=</span><span class="s">"JDBC"</span><span class="nt">/&gt;</span>
            <span class="c">&lt;!--
            dataSource：设置数据源
            属性：
	            type：设置数据源的类型，type="POOLED|UNPOOLED|JNDI"
	            type="POOLED"：使用数据库连接池，即会将创建的连接进行缓存，下次使用可以从缓存中直接获取，不需要重新创建
	            type="UNPOOLED"：不使用数据库连接池，即每次使用连接都需要重新创建
	            type="JNDI"：调用上下文中的数据源
            --&gt;</span>
            <span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">"POOLED"</span><span class="nt">&gt;</span>
                <span class="c">&lt;!--设置驱动类的全类名--&gt;</span>
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"driver"</span> <span class="na">value=</span><span class="s">"${jdbc.driver}"</span><span class="nt">/&gt;</span>
                <span class="c">&lt;!--设置连接数据库的连接地址--&gt;</span>
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"url"</span> <span class="na">value=</span><span class="s">"${jdbc.url}"</span><span class="nt">/&gt;</span>
                <span class="c">&lt;!--设置连接数据库的用户名--&gt;</span>
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"username"</span> <span class="na">value=</span><span class="s">"${jdbc.username}"</span><span class="nt">/&gt;</span>
                <span class="c">&lt;!--设置连接数据库的密码--&gt;</span>
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"password"</span> <span class="na">value=</span><span class="s">"${jdbc.password}"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/dataSource&gt;</span>
        <span class="nt">&lt;/environment&gt;</span>
    <span class="nt">&lt;/environments&gt;</span>
    <span class="c">&lt;!--引入映射文件--&gt;</span>
    <span class="nt">&lt;mappers&gt;</span>
        <span class="c">&lt;!-- &lt;mapper resource="UserMapper.xml"/&gt; --&gt;</span>
        <span class="c">&lt;!--
        以包为单位，将包下所有的映射文件引入核心配置文件
        注意：
			1. 此方式必须保证mapper接口和mapper映射文件必须在相同的包下
			2. mapper接口要和mapper映射文件的名字一致
        --&gt;</span>
        <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">"com.atguigu.mybatis.mapper"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/mappers&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</pre></table></code></div></div><p><img data-src="https://cdn.jsdelivr.net/gh/Casflawed/img-host@master/blog/202207131307369.png" alt="mapper接口和mapper映射文件在同一包下" data-proofer-ignore></p><h1 id="默认的类型别名">默认的类型别名</h1><p><img data-src="https://cdn.jsdelivr.net/gh/Casflawed/img-host@master/blog/202207131308647.png" alt="默认的类型别名1" data-proofer-ignore></p><p><img data-src="https://cdn.jsdelivr.net/gh/Casflawed/img-host@master/blog/202207131308975.png" alt="默认的类型别名2" data-proofer-ignore></p><h1 id="mybatis的增删改查">MyBatis的增删改查</h1><ol><li>添加</ol><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c">&lt;!--int insertUser();--&gt;</span>
<span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">"insertUser"</span><span class="nt">&gt;</span>
	insert into t_user values(null,'admin','123456',23,'男','12345@qq.com')
<span class="nt">&lt;/insert&gt;</span>
</pre></table></code></div></div><ol><li>删除</ol><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c">&lt;!--int deleteUser();--&gt;</span>
<span class="nt">&lt;delete</span> <span class="na">id=</span><span class="s">"deleteUser"</span><span class="nt">&gt;</span>
    delete from t_user where id = 6
<span class="nt">&lt;/delete&gt;</span>
</pre></table></code></div></div><ol><li>修改</ol><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c">&lt;!--int updateUser();--&gt;</span>
<span class="nt">&lt;update</span> <span class="na">id=</span><span class="s">"updateUser"</span><span class="nt">&gt;</span>
    update t_user set username = '张三' where id = 5
<span class="nt">&lt;/update&gt;</span>
</pre></table></code></div></div><ol><li>查询一个实体类对象</ol><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c">&lt;!--User getUserById();--&gt;</span>  
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"getUserById"</span> <span class="na">resultType=</span><span class="s">"com.atguigu.mybatis.bean.User"</span><span class="nt">&gt;</span>  
	select * from t_user where id = 2  
<span class="nt">&lt;/select&gt;</span>
</pre></table></code></div></div><ol><li>查询集合</ol><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c">&lt;!--List&lt;User&gt; getUserList();--&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"getUserList"</span> <span class="na">resultType=</span><span class="s">"com.atguigu.mybatis.bean.User"</span><span class="nt">&gt;</span>
	select * from t_user
<span class="nt">&lt;/select&gt;</span>
</pre></table></code></div></div><p><strong>注意：<br /> 1.查询的标签select必须设置属性resultType或resultMap，用于设置实体类和数据库表的映射关系<br /> ①resultType：自动映射，用于属性名和表中字段名一致的情况<br /> ②resultMap：自定义映射，用于一对多或多对一或字段名和属性名不一致的情况<br /> 2.当查询的数据为多条时，不能使用实体类作为返回值，只能使用集合，否则会抛出异常TooManyResultsException；但是若查询的数据只有一条，可以使用实体类或集合作为返回值</strong></p><h1 id="mybatis获取参数值的两种方式重点">MyBatis获取参数值的两种方式（重点）</h1><p>MyBatis获取参数值的两种方式：${}和#{}</p><ol><li>${}的本质就是字符串拼接，#{}的本质就是占位符赋值<li>${}使用字符串拼接的方式拼接sql，若为字符串类型或日期类型的字段进行赋值时，需要手动加单引号；但是#{}使用占位符赋值的方式拼接sql，此时为字符串类型或日期类型的字段进行赋值时，可以自动添加单引号</ol><h2 id="单个字面量类型的参数">单个字面量类型的参数<a href="#单个字面量类型的参数" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>若mapper接口中的方法参数为单个的字面量类型，此时可以使用${}和#{}以任意的名称（最好见名识意）获取参数的值，注意${}需要手动加单引号</p><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c">&lt;!--User getUserByUsername(String username);--&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"getUserByUsername"</span> <span class="na">resultType=</span><span class="s">"User"</span><span class="nt">&gt;</span>
	select * from t_user where username = #{username}
<span class="nt">&lt;/select&gt;</span>
</pre></table></code></div></div><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c">&lt;!--User getUserByUsername(String username);--&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"getUserByUsername"</span> <span class="na">resultType=</span><span class="s">"User"</span><span class="nt">&gt;</span>  
	select * from t_user where username = '${username}'  
<span class="nt">&lt;/select&gt;</span>
</pre></table></code></div></div><h2 id="多个字面量类型的参数">多个字面量类型的参数<a href="#多个字面量类型的参数" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>若mapper接口中的方法参数为多个时，此时MyBatis会自动将这些参数放在一个map集合中<ol><li>以arg0,arg1…为键，以参数为值；<li>以param1,param2…为键，以参数为值；</ol><li>因此只需要通过${}和#{}访问map集合的键就可以获取相对应的值，注意${}需要手动加单引号。<li>使用arg或者param都行，要注意的是，arg是从arg0开始的，param是从param1开始的</ul><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c">&lt;!--User checkLogin(String username,String password);--&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"checkLogin"</span> <span class="na">resultType=</span><span class="s">"User"</span><span class="nt">&gt;</span>  
	select * from t_user where username = #{arg0} and password = #{arg1}  
<span class="nt">&lt;/select&gt;</span>
</pre></table></code></div></div><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c">&lt;!--User checkLogin(String username,String password);--&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"checkLogin"</span> <span class="na">resultType=</span><span class="s">"User"</span><span class="nt">&gt;</span>
	select * from t_user where username = '${param1}' and password = '${param2}'
<span class="nt">&lt;/select&gt;</span>
</pre></table></code></div></div><h2 id="map集合类型的参数">map集合类型的参数<a href="#map集合类型的参数" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>若mapper接口中的方法需要的参数为多个时，此时可以手动创建map集合，将这些数据放在map中只需要通过${}和#{}访问map集合的键就可以获取相对应的值，注意${}需要手动加单引号</p><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c">&lt;!--User checkLoginByMap(Map&lt;String,Object&gt; map);--&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"checkLoginByMap"</span> <span class="na">resultType=</span><span class="s">"User"</span><span class="nt">&gt;</span>
	select * from t_user where username = #{username} and password = #{password}
<span class="nt">&lt;/select&gt;</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">checkLoginByMap</span><span class="o">()</span> <span class="o">{</span>
	<span class="nc">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="nc">SqlSessionUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
	<span class="nc">ParameterMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="nc">ParameterMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
	<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span><span class="nc">Object</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>
	<span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"usermane"</span><span class="o">,</span><span class="s">"admin"</span><span class="o">);</span>
	<span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"password"</span><span class="o">,</span><span class="s">"123456"</span><span class="o">);</span>
	<span class="nc">User</span> <span class="n">user</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">checkLoginByMap</span><span class="o">(</span><span class="n">map</span><span class="o">);</span>
	<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
<span class="o">}</span>
</pre></table></code></div></div><h2 id="实体类类型的参数">实体类类型的参数<a href="#实体类类型的参数" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>若mapper接口中的方法参数为实体类对象时此时可以使用${}和#{}，通过访问实体类对象中的属性名获取属性值，注意${}需要手动加单引号</p><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c">&lt;!--int insertUser(User user);--&gt;</span>
<span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">"insertUser"</span><span class="nt">&gt;</span>
	insert into t_user values(null,#{username},#{password},#{age},#{sex},#{email})
<span class="nt">&lt;/insert&gt;</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">insertUser</span><span class="o">()</span> <span class="o">{</span>
	<span class="nc">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="nc">SqlSessionUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
	<span class="nc">ParameterMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="nc">ParameterMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
	<span class="nc">User</span> <span class="n">user</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">User</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span><span class="s">"Tom"</span><span class="o">,</span><span class="s">"123456"</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="s">"男"</span><span class="o">,</span><span class="s">"123@321.com"</span><span class="o">);</span>
	<span class="n">mapper</span><span class="o">.</span><span class="na">insertUser</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
<span class="o">}</span>
</pre></table></code></div></div><h2 id="使用param标识参数">使用@Param标识参数<a href="#使用param标识参数" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>可以通过@Param注解标识mapper接口中的方法参数，此时，会将这些参数放在map集合中<ol><li>以@Param注解的value属性值为键，以参数为值；<li>以param1,param2…为键，以参数为值；</ol><li>只需要通过${}和#{}访问map集合的键就可以获取相对应的值，注意${}需要手动加单引号</ul><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c">&lt;!--User CheckLoginByParam(@Param("username") String username, @Param("password") String password);--&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"CheckLoginByParam"</span> <span class="na">resultType=</span><span class="s">"User"</span><span class="nt">&gt;</span>
        select * from t_user where username = #{username} and password = #{password}
    <span class="nt">&lt;/select&gt;</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">checkLoginByParam</span><span class="o">()</span> <span class="o">{</span>
	<span class="nc">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="nc">SqlSessionUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
	<span class="nc">ParameterMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="nc">ParameterMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
	<span class="n">mapper</span><span class="o">.</span><span class="na">CheckLoginByParam</span><span class="o">(</span><span class="s">"admin"</span><span class="o">,</span><span class="s">"123456"</span><span class="o">);</span>
<span class="o">}</span>
</pre></table></code></div></div><h2 id="总结">总结<a href="#总结" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>建议分成两种情况进行处理<ol><li>实体类类型的参数<li>使用@Param标识参数</ol></ul><h1 id="mybatis的各种查询功能">MyBatis的各种查询功能</h1><ol><li>如果查询出的数据只有一条，可以通过<ol><li>实体类对象接收<li>List集合接收<li>Map集合接收，结果<code class="language-plaintext highlighter-rouge">{password=123456, sex=男, id=1, age=23, username=admin}</code></ol><li>如果查询出的数据有多条，一定不能用实体类对象接收，会抛异常TooManyResultsException，可以通过<ol><li>实体类类型的LIst集合接收<li>Map类型的LIst集合接收<li>在mapper接口的方法上添加@MapKey注解</ol></ol><h2 id="查询一个实体类对象">查询一个实体类对象<a href="#查询一个实体类对象" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="cm">/**
 * 根据用户id查询用户信息
 * @param id
 * @return
 */</span>
<span class="nc">User</span> <span class="nf">getUserById</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">"id"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">id</span><span class="o">);</span>
</pre></table></code></div></div><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c">&lt;!--User getUserById(@Param("id") int id);--&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"getUserById"</span> <span class="na">resultType=</span><span class="s">"User"</span><span class="nt">&gt;</span>
	select * from t_user where id = #{id}
<span class="nt">&lt;/select&gt;</span>
</pre></table></code></div></div><h2 id="查询一个list集合">查询一个List集合<a href="#查询一个list集合" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="cm">/**
 * 查询所有用户信息
 * @return
 */</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="nf">getUserList</span><span class="o">();</span>
</pre></table></code></div></div><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c">&lt;!--List&lt;User&gt; getUserList();--&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"getUserList"</span> <span class="na">resultType=</span><span class="s">"User"</span><span class="nt">&gt;</span>
	select * from t_user
<span class="nt">&lt;/select&gt;</span>
</pre></table></code></div></div><h2 id="查询单个数据">查询单个数据<a href="#查询单个数据" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="cm">/**  
 * 查询用户的总记录数  
 * @return  
 * 在MyBatis中，对于Java中常用的类型都设置了类型别名  
 * 例如：java.lang.Integer--&gt;int|integer  
 * 例如：int--&gt;_int|_integer  
 * 例如：Map--&gt;map,List--&gt;list  
 */</span>  
<span class="kt">int</span> <span class="nf">getCount</span><span class="o">();</span>
</pre></table></code></div></div><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c">&lt;!--int getCount();--&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"getCount"</span> <span class="na">resultType=</span><span class="s">"_integer"</span><span class="nt">&gt;</span>
	select count(id) from t_user
<span class="nt">&lt;/select&gt;</span>
</pre></table></code></div></div><h2 id="查询一条数据为map集合">查询一条数据为map集合<a href="#查询一条数据为map集合" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="cm">/**  
 * 根据用户id查询用户信息为map集合  
 * @param id  
 * @return  
 */</span>  
<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="nf">getUserToMap</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">"id"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">id</span><span class="o">);</span>
</pre></table></code></div></div><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c">&lt;!--Map&lt;String, Object&gt; getUserToMap(@Param("id") int id);--&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"getUserToMap"</span> <span class="na">resultType=</span><span class="s">"map"</span><span class="nt">&gt;</span>
	select * from t_user where id = #{id}
<span class="nt">&lt;/select&gt;</span>
<span class="c">&lt;!--结果：{password=123456, sex=男, id=1, age=23, username=admin}--&gt;</span>
</pre></table></code></div></div><h2 id="查询多条数据为map集合">查询多条数据为map集合<a href="#查询多条数据为map集合" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="方法一">方法一<a href="#方法一" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="cm">/**  
 * 查询所有用户信息为map集合  
 * @return  
 * 将表中的数据以map集合的方式查询，一条数据对应一个map；若有多条数据，就会产生多个map集合，此时可以将这些map放在一个list集合中获取  
 */</span>  
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;&gt;</span> <span class="nf">getAllUserToMap</span><span class="o">();</span>
</pre></table></code></div></div><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="c">&lt;!--Map&lt;String, Object&gt; getAllUserToMap();--&gt;</span>  
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"getAllUserToMap"</span> <span class="na">resultType=</span><span class="s">"map"</span><span class="nt">&gt;</span>  
	select * from t_user  
<span class="nt">&lt;/select&gt;</span>
<span class="c">&lt;!--
	结果：
	[{password=123456, sex=男, id=1, age=23, username=admin},
	{password=123456, sex=男, id=2, age=23, username=张三},
	{password=123456, sex=男, id=3, age=23, username=张三}]
--&gt;</span>
</pre></table></code></div></div><h3 id="方法二">方法二<a href="#方法二" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="cm">/**
 * 查询所有用户信息为map集合
 * @return
 * 将表中的数据以map集合的方式查询，一条数据对应一个map；若有多条数据，就会产生多个map集合，并且最终要以一个map的方式返回数据，此时需要通过@MapKey注解设置map集合的键，值是每条数据所对应的map集合
 */</span>
<span class="nd">@MapKey</span><span class="o">(</span><span class="s">"id"</span><span class="o">)</span>
<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="nf">getAllUserToMap</span><span class="o">();</span>
</pre></table></code></div></div><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="c">&lt;!--Map&lt;String, Object&gt; getAllUserToMap();--&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"getAllUserToMap"</span> <span class="na">resultType=</span><span class="s">"map"</span><span class="nt">&gt;</span>
	select * from t_user
<span class="nt">&lt;/select&gt;</span>
<span class="c">&lt;!--
	结果：
	{
	1={password=123456, sex=男, id=1, age=23, username=admin},
	2={password=123456, sex=男, id=2, age=23, username=张三},
	3={password=123456, sex=男, id=3, age=23, username=张三}
	}
--&gt;</span>
</pre></table></code></div></div><h1 id="特殊sql的执行">特殊SQL的执行</h1><h2 id="模糊查询">模糊查询<a href="#模糊查询" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="cm">/**
 * 根据用户名进行模糊查询
 * @param username 
 * @return java.util.List&lt;com.atguigu.mybatis.pojo.User&gt;
 * @date 2022/2/26 21:56
 */</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="nf">getUserByLike</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">"username"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">username</span><span class="o">);</span>
</pre></table></code></div></div><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c">&lt;!--List&lt;User&gt; getUserByLike(@Param("username") String username);--&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"getUserByLike"</span> <span class="na">resultType=</span><span class="s">"User"</span><span class="nt">&gt;</span>
	<span class="c">&lt;!--select * from t_user where username like '%${mohu}%'--&gt;</span>  
	<span class="c">&lt;!--select * from t_user where username like concat('%',#{mohu},'%')--&gt;</span>  
	select * from t_user where username like "%"#{mohu}"%"
<span class="nt">&lt;/select&gt;</span>
</pre></table></code></div></div><ul><li>其中<code class="language-plaintext highlighter-rouge">select * from t_user where username like "%"#{mohu}"%"</code>是最常用的</ul><h2 id="批量删除">批量删除<a href="#批量删除" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>只能使用${}，如果使用#{}，则解析后的sql语句为<code class="language-plaintext highlighter-rouge">delete from t_user where id in ('1,2,3')</code>，这样是将<code class="language-plaintext highlighter-rouge">1,2,3</code>看做是一个整体，只有id为<code class="language-plaintext highlighter-rouge">1,2,3</code>的数据会被删除。正确的语句应该是<code class="language-plaintext highlighter-rouge">delete from t_user where id in (1,2,3)</code>，或者<code class="language-plaintext highlighter-rouge">delete from t_user where id in ('1','2','3')</code></ul><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="cm">/**
 * 根据id批量删除
 * @param ids 
 * @return int
 * @date 2022/2/26 22:06
 */</span>
<span class="kt">int</span> <span class="nf">deleteMore</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">"ids"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">ids</span><span class="o">);</span>
</pre></table></code></div></div><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nt">&lt;delete</span> <span class="na">id=</span><span class="s">"deleteMore"</span><span class="nt">&gt;</span>
	delete from t_user where id in (${ids})
<span class="nt">&lt;/delete&gt;</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="c1">//测试类</span>
<span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">deleteMore</span><span class="o">()</span> <span class="o">{</span>
	<span class="nc">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="nc">SqlSessionUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
	<span class="nc">SQLMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="nc">SQLMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
	<span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">deleteMore</span><span class="o">(</span><span class="s">"1,2,3,8"</span><span class="o">);</span>
	<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
<span class="o">}</span>
</pre></table></code></div></div><h2 id="动态设置表名">动态设置表名<a href="#动态设置表名" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>只能使用${}，因为表名不能加单引号 ```java /**<li>查询指定表中的数据<li>@param tableName<li>@return java.util.List<com.atguigu.mybatis.pojo.User></com.atguigu.mybatis.pojo.User><li>@date 2022/2/27 14:41 */ List<User> getUserByTable(@Param("tableName") String tableName); ```</User></ul><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c">&lt;!--List&lt;User&gt; getUserByTable(@Param("tableName") String tableName);--&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"getUserByTable"</span> <span class="na">resultType=</span><span class="s">"User"</span><span class="nt">&gt;</span>
	select * from ${tableName}
<span class="nt">&lt;/select&gt;</span>
</pre></table></code></div></div><h2 id="添加功能获取自增的主键">添加功能获取自增的主键<a href="#添加功能获取自增的主键" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>使用场景<ul><li>t_clazz(clazz_id,clazz_name)<li>t_student(student_id,student_name,clazz_id)<ol><li>添加班级信息<li>获取新添加的班级的id<li>为班级分配学生，即将某学的班级id修改为新添加的班级的id</ol></ul><li>在mapper.xml中设置两个属性<ul><li>useGeneratedKeys：设置使用自增的主键<li>keyProperty：因为增删改有统一的返回值是受影响的行数，因此只能将获取的自增的主键放在传输的参数user对象的某个属性中</ul></ul><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="cm">/**
 * 添加用户信息
 * @param user 
 * @date 2022/2/27 15:04
 */</span>
<span class="kt">void</span> <span class="nf">insertUser</span><span class="o">(</span><span class="nc">User</span> <span class="n">user</span><span class="o">);</span>
</pre></table></code></div></div><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c">&lt;!--void insertUser(User user);--&gt;</span>
<span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">"insertUser"</span> <span class="na">useGeneratedKeys=</span><span class="s">"true"</span> <span class="na">keyProperty=</span><span class="s">"id"</span><span class="nt">&gt;</span>
	insert into t_user values (null,#{username},#{password},#{age},#{sex},#{email})
<span class="nt">&lt;/insert&gt;</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="c1">//测试类</span>
<span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">insertUser</span><span class="o">()</span> <span class="o">{</span>
	<span class="nc">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="nc">SqlSessionUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
	<span class="nc">SQLMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="nc">SQLMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
	<span class="nc">User</span> <span class="n">user</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">User</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="s">"ton"</span><span class="o">,</span> <span class="s">"123"</span><span class="o">,</span> <span class="mi">23</span><span class="o">,</span> <span class="s">"男"</span><span class="o">,</span> <span class="s">"123@321.com"</span><span class="o">);</span>
	<span class="n">mapper</span><span class="o">.</span><span class="na">insertUser</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
	<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
	<span class="c1">//输出：user{id=10, username='ton', password='123', age=23, sex='男', email='123@321.com'}，自增主键存放到了user的id属性中</span>
<span class="o">}</span>
</pre></table></code></div></div><h1 id="自定义映射resultmap">自定义映射resultMap</h1><h2 id="resultmap处理字段和属性的映射关系">resultMap处理字段和属性的映射关系<a href="#resultmap处理字段和属性的映射关系" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>resultMap：设置自定义映射<ul><li>属性：<ul><li>id：表示自定义映射的唯一标识，不能重复<li>type：查询的数据要映射的实体类的类型</ul><li>子标签：<ul><li>id：设置主键的映射关系<li>result：设置普通字段的映射关系<li>子标签属性：<ul><li>property：设置映射关系中实体类中的属性名<li>column：设置映射关系中表中的字段名</ul></ul></ul><li>若字段名和实体类中的属性名不一致，则可以通过resultMap设置自定义映射，即使字段名和属性名一致的属性也要映射，也就是全部属性都要列出来</ul><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="nt">&lt;resultMap</span> <span class="na">id=</span><span class="s">"empResultMap"</span> <span class="na">type=</span><span class="s">"Emp"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;id</span> <span class="na">property=</span><span class="s">"eid"</span> <span class="na">column=</span><span class="s">"eid"</span><span class="nt">&gt;&lt;/id&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">"empName"</span> <span class="na">column=</span><span class="s">"emp_name"</span><span class="nt">&gt;&lt;/result&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">"age"</span> <span class="na">column=</span><span class="s">"age"</span><span class="nt">&gt;&lt;/result&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">"sex"</span> <span class="na">column=</span><span class="s">"sex"</span><span class="nt">&gt;&lt;/result&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">"email"</span> <span class="na">column=</span><span class="s">"email"</span><span class="nt">&gt;&lt;/result&gt;</span>
<span class="nt">&lt;/resultMap&gt;</span>
<span class="c">&lt;!--List&lt;Emp&gt; getAllEmp();--&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"getAllEmp"</span> <span class="na">resultMap=</span><span class="s">"empResultMap"</span><span class="nt">&gt;</span>
	select * from t_emp
<span class="nt">&lt;/select&gt;</span>
</pre></table></code></div></div><ul><li>若字段名和实体类中的属性名不一致，但是字段名符合数据库的规则（使用_），实体类中的属性名符合Java的规则（使用驼峰）。此时也可通过以下两种方式处理字段名和实体类中的属性的映射关系<ol><li>可以通过为字段起别名的方式，保证和实体类中的属性名保持一致<div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre> <span class="c">&lt;!--List&lt;Emp&gt; getAllEmp();--&gt;</span>
 <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"getAllEmp"</span> <span class="na">resultType=</span><span class="s">"Emp"</span><span class="nt">&gt;</span>
     select eid,emp_name empName,age,sex,email from t_emp
 <span class="nt">&lt;/select&gt;</span>
</pre></table></code></div></div><li><p>可以在MyBatis的核心配置文件中的<code class="language-plaintext highlighter-rouge">setting</code>标签中，设置一个全局配置信息mapUnderscoreToCamelCase，可以在查询表中数据时，自动将_类型的字段名转换为驼峰，例如：字段名user_name，设置了mapUnderscoreToCamelCase，此时字段名就会转换为userName。<a href="#核心配置文件详解">核心配置文件详解</a></p><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre> <span class="nt">&lt;settings&gt;</span>
     <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"mapUnderscoreToCamelCase"</span> <span class="na">value=</span><span class="s">"true"</span><span class="nt">/&gt;</span>
 <span class="nt">&lt;/settings&gt;</span>
</pre></table></code></div></div></ol></ul><h2 id="多对一映射处理">多对一映射处理<a href="#多对一映射处理" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><blockquote><p>查询员工信息以及员工所对应的部门信息</p></blockquote><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Emp</span> <span class="o">{</span>  
	<span class="kd">private</span> <span class="nc">Integer</span> <span class="n">eid</span><span class="o">;</span>  
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">empName</span><span class="o">;</span>  
	<span class="kd">private</span> <span class="nc">Integer</span> <span class="n">age</span><span class="o">;</span>  
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">sex</span><span class="o">;</span>  
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">email</span><span class="o">;</span>  
	<span class="kd">private</span> <span class="nc">Dept</span> <span class="n">dept</span><span class="o">;</span>
	<span class="c1">//...构造器、get、set方法等</span>
<span class="o">}</span>
</pre></table></code></div></div><h3 id="级联方式处理映射关系">级联方式处理映射关系<a href="#级联方式处理映射关系" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="nt">&lt;resultMap</span> <span class="na">id=</span><span class="s">"empAndDeptResultMapOne"</span> <span class="na">type=</span><span class="s">"Emp"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;id</span> <span class="na">property=</span><span class="s">"eid"</span> <span class="na">column=</span><span class="s">"eid"</span><span class="nt">&gt;&lt;/id&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">"empName"</span> <span class="na">column=</span><span class="s">"emp_name"</span><span class="nt">&gt;&lt;/result&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">"age"</span> <span class="na">column=</span><span class="s">"age"</span><span class="nt">&gt;&lt;/result&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">"sex"</span> <span class="na">column=</span><span class="s">"sex"</span><span class="nt">&gt;&lt;/result&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">"email"</span> <span class="na">column=</span><span class="s">"email"</span><span class="nt">&gt;&lt;/result&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">"dept.did"</span> <span class="na">column=</span><span class="s">"did"</span><span class="nt">&gt;&lt;/result&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">"dept.deptName"</span> <span class="na">column=</span><span class="s">"dept_name"</span><span class="nt">&gt;&lt;/result&gt;</span>
<span class="nt">&lt;/resultMap&gt;</span>
<span class="c">&lt;!--Emp getEmpAndDept(@Param("eid")Integer eid);--&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"getEmpAndDept"</span> <span class="na">resultMap=</span><span class="s">"empAndDeptResultMapOne"</span><span class="nt">&gt;</span>
	select * from t_emp left join t_dept on t_emp.eid = t_dept.did where t_emp.eid = #{eid}
<span class="nt">&lt;/select&gt;</span>
</pre></table></code></div></div><h3 id="使用association处理映射关系">使用association处理映射关系<a href="#使用association处理映射关系" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li>association：处理多对一的映射关系<li>property：需要处理多对的映射关系的属性名<li>javaType：该属性的类型</ul><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="nt">&lt;resultMap</span> <span class="na">id=</span><span class="s">"empAndDeptResultMapTwo"</span> <span class="na">type=</span><span class="s">"Emp"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;id</span> <span class="na">property=</span><span class="s">"eid"</span> <span class="na">column=</span><span class="s">"eid"</span><span class="nt">&gt;&lt;/id&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">"empName"</span> <span class="na">column=</span><span class="s">"emp_name"</span><span class="nt">&gt;&lt;/result&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">"age"</span> <span class="na">column=</span><span class="s">"age"</span><span class="nt">&gt;&lt;/result&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">"sex"</span> <span class="na">column=</span><span class="s">"sex"</span><span class="nt">&gt;&lt;/result&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">"email"</span> <span class="na">column=</span><span class="s">"email"</span><span class="nt">&gt;&lt;/result&gt;</span>
	<span class="nt">&lt;association</span> <span class="na">property=</span><span class="s">"dept"</span> <span class="na">javaType=</span><span class="s">"Dept"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;id</span> <span class="na">property=</span><span class="s">"did"</span> <span class="na">column=</span><span class="s">"did"</span><span class="nt">&gt;&lt;/id&gt;</span>
		<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">"deptName"</span> <span class="na">column=</span><span class="s">"dept_name"</span><span class="nt">&gt;&lt;/result&gt;</span>
	<span class="nt">&lt;/association&gt;</span>
<span class="nt">&lt;/resultMap&gt;</span>
<span class="c">&lt;!--Emp getEmpAndDept(@Param("eid")Integer eid);--&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"getEmpAndDept"</span> <span class="na">resultMap=</span><span class="s">"empAndDeptResultMapTwo"</span><span class="nt">&gt;</span>
	select * from t_emp left join t_dept on t_emp.eid = t_dept.did where t_emp.eid = #{eid}
<span class="nt">&lt;/select&gt;</span>
</pre></table></code></div></div><h3 id="分步查询">分步查询<a href="#分步查询" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><h4 id="1-查询员工信息">1. 查询员工信息<a href="#1-查询员工信息" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><ul><li>select：设置分布查询的sql的唯一标识（namespace.SQLId或mapper接口的全类名.方法名）<li>column：设置分步查询的条件</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="c1">//EmpMapper里的方法</span>
<span class="cm">/**
 * 通过分步查询，员工及所对应的部门信息
 * 分步查询第一步：查询员工信息
 * @param  
 * @return com.atguigu.mybatis.pojo.Emp
 * @date 2022/2/27 20:17
 */</span>
<span class="nc">Emp</span> <span class="nf">getEmpAndDeptByStepOne</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">"eid"</span><span class="o">)</span> <span class="nc">Integer</span> <span class="n">eid</span><span class="o">);</span>
</pre></table></code></div></div><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="nt">&lt;resultMap</span> <span class="na">id=</span><span class="s">"empAndDeptByStepResultMap"</span> <span class="na">type=</span><span class="s">"Emp"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;id</span> <span class="na">property=</span><span class="s">"eid"</span> <span class="na">column=</span><span class="s">"eid"</span><span class="nt">&gt;&lt;/id&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">"empName"</span> <span class="na">column=</span><span class="s">"emp_name"</span><span class="nt">&gt;&lt;/result&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">"age"</span> <span class="na">column=</span><span class="s">"age"</span><span class="nt">&gt;&lt;/result&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">"sex"</span> <span class="na">column=</span><span class="s">"sex"</span><span class="nt">&gt;&lt;/result&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">"email"</span> <span class="na">column=</span><span class="s">"email"</span><span class="nt">&gt;&lt;/result&gt;</span>
	<span class="nt">&lt;association</span> <span class="na">property=</span><span class="s">"dept"</span>
				 <span class="na">select=</span><span class="s">"com.atguigu.mybatis.mapper.DeptMapper.getEmpAndDeptByStepTwo"</span>
				 <span class="na">column=</span><span class="s">"did"</span><span class="nt">&gt;&lt;/association&gt;</span>
<span class="nt">&lt;/resultMap&gt;</span>
<span class="c">&lt;!--Emp getEmpAndDeptByStepOne(@Param("eid") Integer eid);--&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"getEmpAndDeptByStepOne"</span> <span class="na">resultMap=</span><span class="s">"empAndDeptByStepResultMap"</span><span class="nt">&gt;</span>
	select * from t_emp where eid = #{eid}
<span class="nt">&lt;/select&gt;</span>
</pre></table></code></div></div><h4 id="2-查询部门信息">2. 查询部门信息<a href="#2-查询部门信息" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="c1">//DeptMapper里的方法</span>
<span class="cm">/**
 * 通过分步查询，员工及所对应的部门信息
 * 分步查询第二步：通过did查询员工对应的部门信息
 * @param
 * @return com.atguigu.mybatis.pojo.Emp
 * @date 2022/2/27 20:23
 */</span>
<span class="nc">Dept</span> <span class="nf">getEmpAndDeptByStepTwo</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">"did"</span><span class="o">)</span> <span class="nc">Integer</span> <span class="n">did</span><span class="o">);</span>
</pre></table></code></div></div><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="c">&lt;!--此处的resultMap仅是处理字段和属性的映射关系--&gt;</span>
<span class="nt">&lt;resultMap</span> <span class="na">id=</span><span class="s">"EmpAndDeptByStepTwoResultMap"</span> <span class="na">type=</span><span class="s">"Dept"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;id</span> <span class="na">property=</span><span class="s">"did"</span> <span class="na">column=</span><span class="s">"did"</span><span class="nt">&gt;&lt;/id&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">"deptName"</span> <span class="na">column=</span><span class="s">"dept_name"</span><span class="nt">&gt;&lt;/result&gt;</span>
<span class="nt">&lt;/resultMap&gt;</span>
<span class="c">&lt;!--Dept getEmpAndDeptByStepTwo(@Param("did") Integer did);--&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"getEmpAndDeptByStepTwo"</span> <span class="na">resultMap=</span><span class="s">"EmpAndDeptByStepTwoResultMap"</span><span class="nt">&gt;</span>
	select * from t_dept where did = #{did}
<span class="nt">&lt;/select&gt;</span>
</pre></table></code></div></div><h2 id="一对多映射处理">一对多映射处理<a href="#一对多映射处理" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Dept</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Integer</span> <span class="n">did</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">deptName</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Emp</span><span class="o">&gt;</span> <span class="n">emps</span><span class="o">;</span>
	<span class="c1">//...构造器、get、set方法等</span>
<span class="o">}</span>
</pre></table></code></div></div><h3 id="collection">collection<a href="#collection" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li>collection：用来处理一对多的映射关系<li>ofType：表示该属性对饮的集合中存储的数据的类型</ul><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="nt">&lt;resultMap</span> <span class="na">id=</span><span class="s">"DeptAndEmpResultMap"</span> <span class="na">type=</span><span class="s">"Dept"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;id</span> <span class="na">property=</span><span class="s">"did"</span> <span class="na">column=</span><span class="s">"did"</span><span class="nt">&gt;&lt;/id&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">"deptName"</span> <span class="na">column=</span><span class="s">"dept_name"</span><span class="nt">&gt;&lt;/result&gt;</span>
	<span class="nt">&lt;collection</span> <span class="na">property=</span><span class="s">"emps"</span> <span class="na">ofType=</span><span class="s">"Emp"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;id</span> <span class="na">property=</span><span class="s">"eid"</span> <span class="na">column=</span><span class="s">"eid"</span><span class="nt">&gt;&lt;/id&gt;</span>
		<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">"empName"</span> <span class="na">column=</span><span class="s">"emp_name"</span><span class="nt">&gt;&lt;/result&gt;</span>
		<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">"age"</span> <span class="na">column=</span><span class="s">"age"</span><span class="nt">&gt;&lt;/result&gt;</span>
		<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">"sex"</span> <span class="na">column=</span><span class="s">"sex"</span><span class="nt">&gt;&lt;/result&gt;</span>
		<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">"email"</span> <span class="na">column=</span><span class="s">"email"</span><span class="nt">&gt;&lt;/result&gt;</span>
	<span class="nt">&lt;/collection&gt;</span>
<span class="nt">&lt;/resultMap&gt;</span>
<span class="c">&lt;!--Dept getDeptAndEmp(@Param("did") Integer did);--&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"getDeptAndEmp"</span> <span class="na">resultMap=</span><span class="s">"DeptAndEmpResultMap"</span><span class="nt">&gt;</span>
	select * from t_dept left join t_emp on t_dept.did = t_emp.did where t_dept.did = #{did}
<span class="nt">&lt;/select&gt;</span>
</pre></table></code></div></div><h3 id="分步查询-1">分步查询<a href="#分步查询-1" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><h4 id="1-查询部门信息">1. 查询部门信息<a href="#1-查询部门信息" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="cm">/**
 * 通过分步查询，查询部门及对应的所有员工信息
 * 分步查询第一步：查询部门信息
 * @param did 
 * @return com.atguigu.mybatis.pojo.Dept
 * @date 2022/2/27 22:04
 */</span>
<span class="nc">Dept</span> <span class="nf">getDeptAndEmpByStepOne</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">"did"</span><span class="o">)</span> <span class="nc">Integer</span> <span class="n">did</span><span class="o">);</span>
</pre></table></code></div></div><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="nt">&lt;resultMap</span> <span class="na">id=</span><span class="s">"DeptAndEmpByStepOneResultMap"</span> <span class="na">type=</span><span class="s">"Dept"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;id</span> <span class="na">property=</span><span class="s">"did"</span> <span class="na">column=</span><span class="s">"did"</span><span class="nt">&gt;&lt;/id&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">"deptName"</span> <span class="na">column=</span><span class="s">"dept_name"</span><span class="nt">&gt;&lt;/result&gt;</span>
	<span class="nt">&lt;collection</span> <span class="na">property=</span><span class="s">"emps"</span>
				<span class="na">select=</span><span class="s">"com.atguigu.mybatis.mapper.EmpMapper.getDeptAndEmpByStepTwo"</span>
				<span class="na">column=</span><span class="s">"did"</span><span class="nt">&gt;&lt;/collection&gt;</span>
<span class="nt">&lt;/resultMap&gt;</span>
<span class="c">&lt;!--Dept getDeptAndEmpByStepOne(@Param("did") Integer did);--&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"getDeptAndEmpByStepOne"</span> <span class="na">resultMap=</span><span class="s">"DeptAndEmpByStepOneResultMap"</span><span class="nt">&gt;</span>
	select * from t_dept where did = #{did}
<span class="nt">&lt;/select&gt;</span>
</pre></table></code></div></div><h4 id="2-根据部门id查询部门中的所有员工">2. 根据部门id查询部门中的所有员工<a href="#2-根据部门id查询部门中的所有员工" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="cm">/**
 * 通过分步查询，查询部门及对应的所有员工信息
 * 分步查询第二步：根据部门id查询部门中的所有员工
 * @param did
 * @return java.util.List&lt;com.atguigu.mybatis.pojo.Emp&gt;
 * @date 2022/2/27 22:10
 */</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Emp</span><span class="o">&gt;</span> <span class="nf">getDeptAndEmpByStepTwo</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">"did"</span><span class="o">)</span> <span class="nc">Integer</span> <span class="n">did</span><span class="o">);</span>
</pre></table></code></div></div><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c">&lt;!--List&lt;Emp&gt; getDeptAndEmpByStepTwo(@Param("did") Integer did);--&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"getDeptAndEmpByStepTwo"</span> <span class="na">resultType=</span><span class="s">"Emp"</span><span class="nt">&gt;</span>
	select * from t_emp where did = #{did}
<span class="nt">&lt;/select&gt;</span>
</pre></table></code></div></div><h2 id="延迟加载">延迟加载<a href="#延迟加载" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>分步查询的优点，可以实现延迟加载，但是必须在核心配置文件中设置全局配置信息：<br /> 1.lazyLoadingEnabled：延迟加载的全局开关。当开启时，所有关联对象都会延迟加载<br /> 2.aggressiveLazyLoading：当开启时，任何方法的调用都会加载该对象的所有属性。 否则，每个属性会按需加载<br /></p><p>此时就可以实现按需加载，获取的数据是什么，就只会执行相应的sql。此时可通过association和collection中的fetchType属性设置当前的分步查询是否使用延迟加载，<code class="language-plaintext highlighter-rouge">fetchType="lazy(延迟加载)|eager(立即加载)"</code></p><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nt">&lt;settings&gt;</span>
	<span class="c">&lt;!--开启延迟加载--&gt;</span>
	<span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"lazyLoadingEnabled"</span> <span class="na">value=</span><span class="s">"true"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/settings&gt;</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">getEmpAndDeptByStepOne</span><span class="o">()</span> <span class="o">{</span>
	<span class="nc">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="nc">SqlSessionUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
	<span class="nc">EmpMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="nc">EmpMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
	<span class="nc">Emp</span> <span class="n">emp</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">getEmpAndDeptByStepOne</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
	<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">emp</span><span class="o">.</span><span class="na">getEmpName</span><span class="o">());</span>
<span class="o">}</span>
</pre></table></code></div></div><ul><li>关闭延迟加载，两条SQL语句都运行了</ul><p><img data-src="https://cdn.jsdelivr.net/gh/Casflawed/img-host@master/blog/202207131316225.png" alt="延迟加载测试1" data-proofer-ignore></p><ul><li>开启延迟加载，只运行获取emp的SQL语句</ul><p><img data-src="https://cdn.jsdelivr.net/gh/Casflawed/img-host@master/blog/202207131316763.png" alt="延迟加载测试2" data-proofer-ignore></p><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">getEmpAndDeptByStepOne</span><span class="o">()</span> <span class="o">{</span>
	<span class="nc">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="nc">SqlSessionUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
	<span class="nc">EmpMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="nc">EmpMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
	<span class="nc">Emp</span> <span class="n">emp</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">getEmpAndDeptByStepOne</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
	<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">emp</span><span class="o">.</span><span class="na">getEmpName</span><span class="o">());</span>
	<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"----------------"</span><span class="o">);</span>
	<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">emp</span><span class="o">.</span><span class="na">getDept</span><span class="o">());</span>
<span class="o">}</span>
</pre></table></code></div></div><ul><li>开启后，需要用到查询dept的时候才会调用相应的SQL语句</ul><p><img data-src="https://cdn.jsdelivr.net/gh/Casflawed/img-host@master/blog/202207131317934.png" alt="延迟加载测试3" data-proofer-ignore></p><ul><li>fetchType：当开启了全局的延迟加载之后，可以通过该属性手动控制延迟加载的效果，<code class="language-plaintext highlighter-rouge">fetchType="lazy(延迟加载)|eager(立即加载)"</code></ul><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="nt">&lt;resultMap</span> <span class="na">id=</span><span class="s">"empAndDeptByStepResultMap"</span> <span class="na">type=</span><span class="s">"Emp"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;id</span> <span class="na">property=</span><span class="s">"eid"</span> <span class="na">column=</span><span class="s">"eid"</span><span class="nt">&gt;&lt;/id&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">"empName"</span> <span class="na">column=</span><span class="s">"emp_name"</span><span class="nt">&gt;&lt;/result&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">"age"</span> <span class="na">column=</span><span class="s">"age"</span><span class="nt">&gt;&lt;/result&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">"sex"</span> <span class="na">column=</span><span class="s">"sex"</span><span class="nt">&gt;&lt;/result&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">"email"</span> <span class="na">column=</span><span class="s">"email"</span><span class="nt">&gt;&lt;/result&gt;</span>
	<span class="nt">&lt;association</span> <span class="na">property=</span><span class="s">"dept"</span>
				 <span class="na">select=</span><span class="s">"com.atguigu.mybatis.mapper.DeptMapper.getEmpAndDeptByStepTwo"</span>
				 <span class="na">column=</span><span class="s">"did"</span>
				 <span class="na">fetchType=</span><span class="s">"lazy"</span><span class="nt">&gt;&lt;/association&gt;</span>
<span class="nt">&lt;/resultMap&gt;</span>
</pre></table></code></div></div><h1 id="动态sql">动态SQL</h1><ul><li>Mybatis框架的动态SQL技术是一种根据特定条件动态拼装SQL语句的功能，它存在的意义是为了解决拼接SQL语句字符串时的痛点问题</ul><h2 id="if">if<a href="#if" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>if标签可通过test属性（即传递过来的数据）的表达式进行判断，若表达式的结果为true，则标签中的内容会执行；反之标签中的内容不会执行<li>在where后面添加一个恒成立条件<code class="language-plaintext highlighter-rouge">1=1</code><ul><li>这个恒成立条件并不会影响查询的结果<li>这个<code class="language-plaintext highlighter-rouge">1=1</code>可以用来拼接<code class="language-plaintext highlighter-rouge">and</code>语句，例如：当empName为null时<ul><li>如果不加上恒成立条件，则SQL语句为<code class="language-plaintext highlighter-rouge">select * from t_emp where and age = ? and sex = ? and email = ?</code>，此时<code class="language-plaintext highlighter-rouge">where</code>会与<code class="language-plaintext highlighter-rouge">and</code>连用，SQL语句会报错<li>如果加上一个恒成立条件，则SQL语句为<code class="language-plaintext highlighter-rouge">select * from t_emp where 1= 1 and age = ? and sex = ? and email = ?</code>，此时不报错</ul></ul></ul><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="c">&lt;!--List&lt;Emp&gt; getEmpByCondition(Emp emp);--&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"getEmpByCondition"</span> <span class="na">resultType=</span><span class="s">"Emp"</span><span class="nt">&gt;</span>
	select * from t_emp where 1=1
	<span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">"empName != null and empName !=''"</span><span class="nt">&gt;</span>
		and emp_name = #{empName}
	<span class="nt">&lt;/if&gt;</span>
	<span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">"age != null and age !=''"</span><span class="nt">&gt;</span>
		and age = #{age}
	<span class="nt">&lt;/if&gt;</span>
	<span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">"sex != null and sex !=''"</span><span class="nt">&gt;</span>
		and sex = #{sex}
	<span class="nt">&lt;/if&gt;</span>
	<span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">"email != null and email !=''"</span><span class="nt">&gt;</span>
		and email = #{email}
	<span class="nt">&lt;/if&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</pre></table></code></div></div><h2 id="where">where<a href="#where" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>where和if一般结合使用：<ul><li>若where标签中的if条件都不满足，则where标签没有任何功能，即不会添加where关键字<li>若where标签中的if条件满足，则where标签会自动添加where关键字，并将条件最前方多余的and/or去掉</ul></ul><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="c">&lt;!--List&lt;Emp&gt; getEmpByCondition(Emp emp);--&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"getEmpByCondition"</span> <span class="na">resultType=</span><span class="s">"Emp"</span><span class="nt">&gt;</span>
	select * from t_emp
	<span class="nt">&lt;where&gt;</span>
		<span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">"empName != null and empName !=''"</span><span class="nt">&gt;</span>
			emp_name = #{empName}
		<span class="nt">&lt;/if&gt;</span>
		<span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">"age != null and age !=''"</span><span class="nt">&gt;</span>
			and age = #{age}
		<span class="nt">&lt;/if&gt;</span>
		<span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">"sex != null and sex !=''"</span><span class="nt">&gt;</span>
			and sex = #{sex}
		<span class="nt">&lt;/if&gt;</span>
		<span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">"email != null and email !=''"</span><span class="nt">&gt;</span>
			and email = #{email}
		<span class="nt">&lt;/if&gt;</span>
	<span class="nt">&lt;/where&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</pre></table></code></div></div><ul><li>注意：where标签不能去掉条件后多余的and/or</ul><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c">&lt;!--这种用法是错误的，只能去掉条件前面的and/or，条件后面的不行--&gt;</span>
<span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">"empName != null and empName !=''"</span><span class="nt">&gt;</span>
emp_name = #{empName} and
<span class="nt">&lt;/if&gt;</span>
<span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">"age != null and age !=''"</span><span class="nt">&gt;</span>
	age = #{age}
<span class="nt">&lt;/if&gt;</span>
</pre></table></code></div></div><h2 id="trim">trim<a href="#trim" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>trim用于去掉或添加标签中的内容<li>常用属性<ul><li>prefix：在trim标签中的内容的前面添加某些内容<li>suffix：在trim标签中的内容的后面添加某些内容<li>prefixOverrides：在trim标签中的内容的前面去掉某些内容<li>suffixOverrides：在trim标签中的内容的后面去掉某些内容</ul><li>若trim中的标签都不满足条件，则trim标签没有任何效果，也就是只剩下<code class="language-plaintext highlighter-rouge">select * from t_emp</code></ul><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="c">&lt;!--List&lt;Emp&gt; getEmpByCondition(Emp emp);--&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"getEmpByCondition"</span> <span class="na">resultType=</span><span class="s">"Emp"</span><span class="nt">&gt;</span>
	select * from t_emp
	<span class="nt">&lt;trim</span> <span class="na">prefix=</span><span class="s">"where"</span> <span class="na">suffixOverrides=</span><span class="s">"and|or"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">"empName != null and empName !=''"</span><span class="nt">&gt;</span>
			emp_name = #{empName} and
		<span class="nt">&lt;/if&gt;</span>
		<span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">"age != null and age !=''"</span><span class="nt">&gt;</span>
			age = #{age} and
		<span class="nt">&lt;/if&gt;</span>
		<span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">"sex != null and sex !=''"</span><span class="nt">&gt;</span>
			sex = #{sex} or
		<span class="nt">&lt;/if&gt;</span>
		<span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">"email != null and email !=''"</span><span class="nt">&gt;</span>
			email = #{email}
		<span class="nt">&lt;/if&gt;</span>
	<span class="nt">&lt;/trim&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="c1">//测试类</span>
<span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">getEmpByCondition</span><span class="o">()</span> <span class="o">{</span>
	<span class="nc">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="nc">SqlSessionUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
	<span class="nc">DynamicSQLMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="nc">DynamicSQLMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
	<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Emp</span><span class="o">&gt;</span> <span class="n">emps</span><span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">getEmpByCondition</span><span class="o">(</span><span class="k">new</span> <span class="nc">Emp</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="s">"张三"</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="kc">null</span><span class="o">));</span>
	<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">emps</span><span class="o">);</span>
<span class="o">}</span>
</pre></table></code></div></div><p><img data-src="https://cdn.jsdelivr.net/gh/Casflawed/img-host@masterblog/202207131318916.png" alt="trim测试结果" data-proofer-ignore></p><h2 id="choosewhenotherwise">choose、when、otherwise<a href="#choosewhenotherwise" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li><code class="language-plaintext highlighter-rouge">choose、when、otherwise</code>相当于<code class="language-plaintext highlighter-rouge">if...else if..else</code><li>when至少要有一个，otherwise至多只有一个</ul><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"getEmpByChoose"</span> <span class="na">resultType=</span><span class="s">"Emp"</span><span class="nt">&gt;</span>
	select * from t_emp
	<span class="nt">&lt;where&gt;</span>
		<span class="nt">&lt;choose&gt;</span>
			<span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">"empName != null and empName != ''"</span><span class="nt">&gt;</span>
				emp_name = #{empName}
			<span class="nt">&lt;/when&gt;</span>
			<span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">"age != null and age != ''"</span><span class="nt">&gt;</span>
				age = #{age}
			<span class="nt">&lt;/when&gt;</span>
			<span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">"sex != null and sex != ''"</span><span class="nt">&gt;</span>
				sex = #{sex}
			<span class="nt">&lt;/when&gt;</span>
			<span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">"email != null and email != ''"</span><span class="nt">&gt;</span>
				email = #{email}
			<span class="nt">&lt;/when&gt;</span>
			<span class="nt">&lt;otherwise&gt;</span>
				did = 1
			<span class="nt">&lt;/otherwise&gt;</span>
		<span class="nt">&lt;/choose&gt;</span>
	<span class="nt">&lt;/where&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">getEmpByChoose</span><span class="o">()</span> <span class="o">{</span>
	<span class="nc">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="nc">SqlSessionUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
	<span class="nc">DynamicSQLMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="nc">DynamicSQLMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
	<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Emp</span><span class="o">&gt;</span> <span class="n">emps</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">getEmpByChoose</span><span class="o">(</span><span class="k">new</span> <span class="nc">Emp</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="s">"张三"</span><span class="o">,</span> <span class="mi">23</span><span class="o">,</span> <span class="s">"男"</span><span class="o">,</span> <span class="s">"123@qq.com"</span><span class="o">,</span> <span class="kc">null</span><span class="o">));</span>
	<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">emps</span><span class="o">);</span>
<span class="o">}</span>
</pre></table></code></div></div><p><img data-src="https://cdn.jsdelivr.net/gh/Casflawed/img-host@master/blog/202207131319985.png" alt="choose测试结果" data-proofer-ignore></p><ul><li>相当于<code class="language-plaintext highlighter-rouge">if a else if b else if c else d</code>，只会执行其中一个</ul><h2 id="foreach">foreach<a href="#foreach" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>属性：<ul><li>collection：设置要循环的数组或集合<li>item：表示集合或数组中的每一个数据<li>separator：设置循环体之间的分隔符，分隔符前后默认有一个空格，如<code class="language-plaintext highlighter-rouge"> , </code><li>open：设置foreach标签中的内容的开始符<li>close：设置foreach标签中的内容的结束符</ul><li>批量删除</ul><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c">&lt;!--int deleteMoreByArray(Integer[] eids);--&gt;</span>
<span class="nt">&lt;delete</span> <span class="na">id=</span><span class="s">"deleteMoreByArray"</span><span class="nt">&gt;</span>
	delete from t_emp where eid in
	<span class="nt">&lt;foreach</span> <span class="na">collection=</span><span class="s">"eids"</span> <span class="na">item=</span><span class="s">"eid"</span> <span class="na">separator=</span><span class="s">","</span> <span class="na">open=</span><span class="s">"("</span> <span class="na">close=</span><span class="s">")"</span><span class="nt">&gt;</span>
		#{eid}
	<span class="nt">&lt;/foreach&gt;</span>
<span class="nt">&lt;/delete&gt;</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">deleteMoreByArray</span><span class="o">()</span> <span class="o">{</span>
	<span class="nc">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="nc">SqlSessionUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
	<span class="nc">DynamicSQLMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="nc">DynamicSQLMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
	<span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">deleteMoreByArray</span><span class="o">(</span><span class="k">new</span> <span class="nc">Integer</span><span class="o">[]{</span><span class="mi">6</span><span class="o">,</span> <span class="mi">7</span><span class="o">,</span> <span class="mi">8</span><span class="o">,</span> <span class="mi">9</span><span class="o">});</span>
	<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
<span class="o">}</span>
</pre></table></code></div></div><p><img data-src="https://cdn.jsdelivr.net/gh/Casflawed/img-host@master/blog/202207131320130.png" alt="foreach测试结果1" data-proofer-ignore></p><ul><li>批量添加</ul><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c">&lt;!--int insertMoreByList(@Param("emps") List&lt;Emp&gt; emps);--&gt;</span>
<span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">"insertMoreByList"</span><span class="nt">&gt;</span>
	insert into t_emp values
	<span class="nt">&lt;foreach</span> <span class="na">collection=</span><span class="s">"emps"</span> <span class="na">item=</span><span class="s">"emp"</span> <span class="na">separator=</span><span class="s">","</span><span class="nt">&gt;</span>
		(null,#{emp.empName},#{emp.age},#{emp.sex},#{emp.email},null)
	<span class="nt">&lt;/foreach&gt;</span>
<span class="nt">&lt;/insert&gt;</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">insertMoreByList</span><span class="o">()</span> <span class="o">{</span>
	<span class="nc">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="nc">SqlSessionUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
	<span class="nc">DynamicSQLMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="nc">DynamicSQLMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
	<span class="nc">Emp</span> <span class="n">emp1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Emp</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span><span class="s">"a"</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="s">"男"</span><span class="o">,</span><span class="s">"123@321.com"</span><span class="o">,</span><span class="kc">null</span><span class="o">);</span>
	<span class="nc">Emp</span> <span class="n">emp2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Emp</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span><span class="s">"b"</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="s">"男"</span><span class="o">,</span><span class="s">"123@321.com"</span><span class="o">,</span><span class="kc">null</span><span class="o">);</span>
	<span class="nc">Emp</span> <span class="n">emp3</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Emp</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span><span class="s">"c"</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="s">"男"</span><span class="o">,</span><span class="s">"123@321.com"</span><span class="o">,</span><span class="kc">null</span><span class="o">);</span>
	<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Emp</span><span class="o">&gt;</span> <span class="n">emps</span> <span class="o">=</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">emp1</span><span class="o">,</span> <span class="n">emp2</span><span class="o">,</span> <span class="n">emp3</span><span class="o">);</span>
	<span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">insertMoreByList</span><span class="o">(</span><span class="n">emps</span><span class="o">);</span>
	<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
<span class="o">}</span>
</pre></table></code></div></div><p><img data-src="https://cdn.jsdelivr.net/gh/Casflawed/img-host@master/blog/202207131321016.png" alt="foreach测试结果2" data-proofer-ignore></p><h2 id="sql片段">SQL片段<a href="#sql片段" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>sql片段，可以记录一段公共sql片段，在使用的地方通过include标签进行引入<li>声明sql片段：<code class="language-plaintext highlighter-rouge">&lt;sql&gt;</code>标签</ul><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;sql</span> <span class="na">id=</span><span class="s">"empColumns"</span><span class="nt">&gt;</span>eid,emp_name,age,sex,email<span class="nt">&lt;/sql&gt;</span>
</pre></table></code></div></div><ul><li>引用sql片段：<code class="language-plaintext highlighter-rouge">&lt;include&gt;</code>标签</ul><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c">&lt;!--List&lt;Emp&gt; getEmpByCondition(Emp emp);--&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"getEmpByCondition"</span> <span class="na">resultType=</span><span class="s">"Emp"</span><span class="nt">&gt;</span>
	select <span class="nt">&lt;include</span> <span class="na">refid=</span><span class="s">"empColumns"</span><span class="nt">&gt;&lt;/include&gt;</span> from t_emp
<span class="nt">&lt;/select&gt;</span>
</pre></table></code></div></div><h1 id="mybatis的缓存">MyBatis的缓存</h1><h2 id="mybatis的一级缓存">MyBatis的一级缓存<a href="#mybatis的一级缓存" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>一级缓存是SqlSession级别的，通过同一个SqlSession查询的数据会被缓存，下次查询相同的数据，就会从缓存中直接获取，不会从数据库重新访问<li>使一级缓存失效的四种情况：<ol><li>不同的SqlSession对应不同的一级缓存<li>同一个SqlSession但是查询条件不同<li>同一个SqlSession两次查询期间执行了任何一次增删改操作<li>同一个SqlSession两次查询期间手动清空了缓存</ol></ul><h2 id="mybatis的二级缓存">MyBatis的二级缓存<a href="#mybatis的二级缓存" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>二级缓存是SqlSessionFactory级别，通过同一个SqlSessionFactory创建的SqlSession查询的结果会被缓存；此后若再次执行相同的查询语句，结果就会从缓存中获取<li>二级缓存开启的条件<ol><li>在核心配置文件中，设置全局配置属性cacheEnabled=”true”，默认为true，不需要设置<li>在映射文件中设置标签<cache></cache><li>二级缓存必须在SqlSession关闭或提交之后有效<li>查询的数据所转换的实体类类型必须实现序列化的接口</ol><li>使二级缓存失效的情况：两次查询之间执行了任意的增删改，会使一级和二级缓存同时失效</ul><h2 id="二级缓存的相关配置">二级缓存的相关配置<a href="#二级缓存的相关配置" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>在mapper配置文件中添加的cache标签可以设置一些属性<li>eviction属性：缓存回收策略<ul><li>LRU（Least Recently Used） – 最近最少使用的：移除最长时间不被使用的对象。<li>FIFO（First in First out） – 先进先出：按对象进入缓存的顺序来移除它们。<li>SOFT – 软引用：移除基于垃圾回收器状态和软引用规则的对象。<li>WEAK – 弱引用：更积极地移除基于垃圾收集器状态和弱引用规则的对象。<li>默认的是 LRU</ul><li>flushInterval属性：刷新间隔，单位毫秒<ul><li>默认情况是不设置，也就是没有刷新间隔，缓存仅仅调用语句（增删改）时刷新</ul><li>size属性：引用数目，正整数<ul><li>代表缓存最多可以存储多少个对象，太大容易导致内存溢出</ul><li>readOnly属性：只读，true/false<ul><li>true：只读缓存；会给所有调用者返回缓存对象的相同实例。因此这些对象不能被修改。这提供了很重要的性能优势。<li>false：读写缓存；会返回缓存对象的拷贝（通过序列化）。这会慢一些，但是安全，因此默认是false</ul></ul><h2 id="mybatis缓存查询的顺序">MyBatis缓存查询的顺序<a href="#mybatis缓存查询的顺序" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>先查询二级缓存，因为二级缓存中可能会有其他程序已经查出来的数据，可以拿来直接使用<li>如果二级缓存没有命中，再查询一级缓存<li>如果一级缓存也没有命中，则查询数据库<li>SqlSession关闭之后，一级缓存中的数据会写入二级缓存</ul><h2 id="整合第三方缓存ehcache了解">整合第三方缓存EHCache（了解）<a href="#整合第三方缓存ehcache了解" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="添加依赖">添加依赖<a href="#添加依赖" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="c">&lt;!-- Mybatis EHCache整合包 --&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
	<span class="nt">&lt;groupId&gt;</span>org.mybatis.caches<span class="nt">&lt;/groupId&gt;</span>
	<span class="nt">&lt;artifactId&gt;</span>mybatis-ehcache<span class="nt">&lt;/artifactId&gt;</span>
	<span class="nt">&lt;version&gt;</span>1.2.1<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
<span class="c">&lt;!-- slf4j日志门面的一个具体实现 --&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
	<span class="nt">&lt;groupId&gt;</span>ch.qos.logback<span class="nt">&lt;/groupId&gt;</span>
	<span class="nt">&lt;artifactId&gt;</span>logback-classic<span class="nt">&lt;/artifactId&gt;</span>
	<span class="nt">&lt;version&gt;</span>1.2.3<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></table></code></div></div><h3 id="各个jar包的功能">各个jar包的功能<a href="#各个jar包的功能" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="table-wrapper"><table><thead><tr><th>jar包名称<th>作用<tbody><tr><td>mybatis-ehcache<td>Mybatis和EHCache的整合包<tr><td>ehcache<td>EHCache核心包<tr><td>slf4j-api<td>SLF4J日志门面包<tr><td>logback-classic<td>支持SLF4J门面接口的一个具体实现</table></div><h3 id="创建ehcache的配置文件ehcachexml">创建EHCache的配置文件ehcache.xml<a href="#创建ehcache的配置文件ehcachexml" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li>名字必须叫<code class="language-plaintext highlighter-rouge">ehcache.xml</code></ul><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="utf-8" ?&gt;</span>
<span class="nt">&lt;ehcache</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
         <span class="na">xsi:noNamespaceSchemaLocation=</span><span class="s">"../config/ehcache.xsd"</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- 磁盘保存路径 --&gt;</span>
    <span class="nt">&lt;diskStore</span> <span class="na">path=</span><span class="s">"D:\atguigu\ehcache"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;defaultCache</span>
            <span class="na">maxElementsInMemory=</span><span class="s">"1000"</span>
            <span class="na">maxElementsOnDisk=</span><span class="s">"10000000"</span>
            <span class="na">eternal=</span><span class="s">"false"</span>
            <span class="na">overflowToDisk=</span><span class="s">"true"</span>
            <span class="na">timeToIdleSeconds=</span><span class="s">"120"</span>
            <span class="na">timeToLiveSeconds=</span><span class="s">"120"</span>
            <span class="na">diskExpiryThreadIntervalSeconds=</span><span class="s">"120"</span>
            <span class="na">memoryStoreEvictionPolicy=</span><span class="s">"LRU"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/defaultCache&gt;</span>
<span class="nt">&lt;/ehcache&gt;</span>
</pre></table></code></div></div><h3 id="设置二级缓存的类型">设置二级缓存的类型<a href="#设置二级缓存的类型" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li>在xxxMapper.xml文件中设置二级缓存类型</ul><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;cache</span> <span class="na">type=</span><span class="s">"org.mybatis.caches.ehcache.EhcacheCache"</span><span class="nt">/&gt;</span>
</pre></table></code></div></div><h3 id="加入logback日志">加入logback日志<a href="#加入logback日志" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li>存在SLF4J时，作为简易日志的log4j将失效，此时我们需要借助SLF4J的具体实现logback来打印日志。创建logback的配置文件<code class="language-plaintext highlighter-rouge">logback.xml</code>，名字固定，不可改变</ul><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;configuration</span> <span class="na">debug=</span><span class="s">"true"</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- 指定日志输出的位置 --&gt;</span>
    <span class="nt">&lt;appender</span> <span class="na">name=</span><span class="s">"STDOUT"</span> <span class="na">class=</span><span class="s">"ch.qos.logback.core.ConsoleAppender"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;encoder&gt;</span>
            <span class="c">&lt;!-- 日志输出的格式 --&gt;</span>
            <span class="c">&lt;!-- 按照顺序分别是：时间、日志级别、线程名称、打印日志的类、日志主体内容、换行 --&gt;</span>
            <span class="nt">&lt;pattern&gt;</span>[%d{HH:mm:ss.SSS}] [%-5level] [%thread] [%logger] [%msg]%n<span class="nt">&lt;/pattern&gt;</span>
        <span class="nt">&lt;/encoder&gt;</span>
    <span class="nt">&lt;/appender&gt;</span>
    <span class="c">&lt;!-- 设置全局日志级别。日志级别按顺序分别是：DEBUG、INFO、WARN、ERROR --&gt;</span>
    <span class="c">&lt;!-- 指定任何一个日志级别都只打印当前级别和后面级别的日志。 --&gt;</span>
    <span class="nt">&lt;root</span> <span class="na">level=</span><span class="s">"DEBUG"</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- 指定打印日志的appender，这里通过“STDOUT”引用了前面配置的appender --&gt;</span>
        <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"STDOUT"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/root&gt;</span>
    <span class="c">&lt;!-- 根据特殊需求指定局部日志级别 --&gt;</span>
    <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">"com.atguigu.crowd.mapper"</span> <span class="na">level=</span><span class="s">"DEBUG"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</pre></table></code></div></div><h3 id="ehcache配置文件说明">EHCache配置文件说明<a href="#ehcache配置文件说明" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="table-wrapper"><table><thead><tr><th>属性名<th>是否必须<th>作用<tbody><tr><td>maxElementsInMemory<td>是<td>在内存中缓存的element的最大数目<tr><td>maxElementsOnDisk<td>是<td>在磁盘上缓存的element的最大数目，若是0表示无穷大<tr><td>eternal<td>是<td>设定缓存的elements是否永远不过期。 如果为true，则缓存的数据始终有效， 如果为false那么还要根据timeToIdleSeconds、timeToLiveSeconds判断<tr><td>overflowToDisk<td>是<td>设定当内存缓存溢出的时候是否将过期的element缓存到磁盘上<tr><td>timeToIdleSeconds<td>否<td>当缓存在EhCache中的数据前后两次访问的时间超过timeToIdleSeconds的属性取值时， 这些数据便会删除，默认值是0,也就是可闲置时间无穷大<tr><td>timeToLiveSeconds<td>否<td>缓存element的有效生命期，默认是0.,也就是element存活时间无穷大<tr><td>diskSpoolBufferSizeMB<td>否<td>DiskStore(磁盘缓存)的缓存区大小。默认是30MB。每个Cache都应该有自己的一个缓冲区<tr><td>diskPersistent<td>否<td>在VM重启的时候是否启用磁盘保存EhCache中的数据，默认是false<tr><td>diskExpiryThreadIntervalSeconds<td>否<td>磁盘缓存的清理线程运行间隔，默认是120秒。每个120s， 相应的线程会进行一次EhCache中数据的清理工作<tr><td>memoryStoreEvictionPolicy<td>否<td>当内存缓存达到最大，有新的element加入的时候， 移除缓存中element的策略。 默认是LRU（最近最少使用），可选的有LFU（最不常使用）和FIFO（先进先出</table></div><h1 id="mybatis的逆向工程">MyBatis的逆向工程</h1><ul><li>正向工程：先创建Java实体类，由框架负责根据实体类生成数据库表。Hibernate是支持正向工程的<li>逆向工程：先创建数据库表，由框架负责根据数据库表，反向生成如下资源：<ul><li>Java实体类<li>Mapper接口<li>Mapper映射文件<h2 id="创建逆向工程的步骤">创建逆向工程的步骤<a href="#创建逆向工程的步骤" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2></ul></ul><h3 id="添加依赖和插件">添加依赖和插件<a href="#添加依赖和插件" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
</pre><td class="rouge-code"><pre><span class="nt">&lt;dependencies&gt;</span>
	<span class="c">&lt;!-- MyBatis核心依赖包 --&gt;</span>
	<span class="nt">&lt;dependency&gt;</span>
		<span class="nt">&lt;groupId&gt;</span>org.mybatis<span class="nt">&lt;/groupId&gt;</span>
		<span class="nt">&lt;artifactId&gt;</span>mybatis<span class="nt">&lt;/artifactId&gt;</span>
		<span class="nt">&lt;version&gt;</span>3.5.9<span class="nt">&lt;/version&gt;</span>
	<span class="nt">&lt;/dependency&gt;</span>
	<span class="c">&lt;!-- junit测试 --&gt;</span>
	<span class="nt">&lt;dependency&gt;</span>
		<span class="nt">&lt;groupId&gt;</span>junit<span class="nt">&lt;/groupId&gt;</span>
		<span class="nt">&lt;artifactId&gt;</span>junit<span class="nt">&lt;/artifactId&gt;</span>
		<span class="nt">&lt;version&gt;</span>4.13.2<span class="nt">&lt;/version&gt;</span>
		<span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
	<span class="nt">&lt;/dependency&gt;</span>
	<span class="c">&lt;!-- MySQL驱动 --&gt;</span>
	<span class="nt">&lt;dependency&gt;</span>
		<span class="nt">&lt;groupId&gt;</span>mysql<span class="nt">&lt;/groupId&gt;</span>
		<span class="nt">&lt;artifactId&gt;</span>mysql-connector-java<span class="nt">&lt;/artifactId&gt;</span>
		<span class="nt">&lt;version&gt;</span>8.0.27<span class="nt">&lt;/version&gt;</span>
	<span class="nt">&lt;/dependency&gt;</span>
	<span class="c">&lt;!-- log4j日志 --&gt;</span>
	<span class="nt">&lt;dependency&gt;</span>
		<span class="nt">&lt;groupId&gt;</span>log4j<span class="nt">&lt;/groupId&gt;</span>
		<span class="nt">&lt;artifactId&gt;</span>log4j<span class="nt">&lt;/artifactId&gt;</span>
		<span class="nt">&lt;version&gt;</span>1.2.17<span class="nt">&lt;/version&gt;</span>
	<span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;/dependencies&gt;</span>
<span class="c">&lt;!-- 控制Maven在构建过程中相关配置 --&gt;</span>
<span class="nt">&lt;build&gt;</span>
	<span class="c">&lt;!-- 构建过程中用到的插件 --&gt;</span>
	<span class="nt">&lt;plugins&gt;</span>
		<span class="c">&lt;!-- 具体插件，逆向工程的操作是以构建过程中插件形式出现的 --&gt;</span>
		<span class="nt">&lt;plugin&gt;</span>
			<span class="nt">&lt;groupId&gt;</span>org.mybatis.generator<span class="nt">&lt;/groupId&gt;</span>
			<span class="nt">&lt;artifactId&gt;</span>mybatis-generator-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
			<span class="nt">&lt;version&gt;</span>1.3.0<span class="nt">&lt;/version&gt;</span>
			<span class="c">&lt;!-- 插件的依赖 --&gt;</span>
			<span class="nt">&lt;dependencies&gt;</span>
				<span class="c">&lt;!-- 逆向工程的核心依赖 --&gt;</span>
				<span class="nt">&lt;dependency&gt;</span>
					<span class="nt">&lt;groupId&gt;</span>org.mybatis.generator<span class="nt">&lt;/groupId&gt;</span>
					<span class="nt">&lt;artifactId&gt;</span>mybatis-generator-core<span class="nt">&lt;/artifactId&gt;</span>
					<span class="nt">&lt;version&gt;</span>1.3.2<span class="nt">&lt;/version&gt;</span>
				<span class="nt">&lt;/dependency&gt;</span>
				<span class="c">&lt;!-- 数据库连接池 --&gt;</span>
				<span class="nt">&lt;dependency&gt;</span>
					<span class="nt">&lt;groupId&gt;</span>com.mchange<span class="nt">&lt;/groupId&gt;</span>
					<span class="nt">&lt;artifactId&gt;</span>c3p0<span class="nt">&lt;/artifactId&gt;</span>
					<span class="nt">&lt;version&gt;</span>0.9.2<span class="nt">&lt;/version&gt;</span>
				<span class="nt">&lt;/dependency&gt;</span>
				<span class="c">&lt;!-- MySQL驱动 --&gt;</span>
				<span class="nt">&lt;dependency&gt;</span>
					<span class="nt">&lt;groupId&gt;</span>mysql<span class="nt">&lt;/groupId&gt;</span>
					<span class="nt">&lt;artifactId&gt;</span>mysql-connector-java<span class="nt">&lt;/artifactId&gt;</span>
					<span class="nt">&lt;version&gt;</span>8.0.27<span class="nt">&lt;/version&gt;</span>
				<span class="nt">&lt;/dependency&gt;</span>
			<span class="nt">&lt;/dependencies&gt;</span>
		<span class="nt">&lt;/plugin&gt;</span>
	<span class="nt">&lt;/plugins&gt;</span>
<span class="nt">&lt;/build&gt;</span>
</pre></table></code></div></div><h3 id="创建mybatis的核心配置文件-1">创建MyBatis的核心配置文件<a href="#创建mybatis的核心配置文件-1" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="cp">&lt;!DOCTYPE configuration
        PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;</span>
<span class="nt">&lt;configuration&gt;</span>
    <span class="nt">&lt;properties</span> <span class="na">resource=</span><span class="s">"jdbc.properties"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;typeAliases&gt;</span>
        <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">""</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/typeAliases&gt;</span>
    <span class="nt">&lt;environments</span> <span class="na">default=</span><span class="s">"development"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">"development"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;transactionManager</span> <span class="na">type=</span><span class="s">"JDBC"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">"POOLED"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"driver"</span> <span class="na">value=</span><span class="s">"${jdbc.driver}"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"url"</span> <span class="na">value=</span><span class="s">"${jdbc.url}"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"username"</span> <span class="na">value=</span><span class="s">"${jdbc.username}"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"password"</span> <span class="na">value=</span><span class="s">"${jdbc.password}"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/dataSource&gt;</span>
        <span class="nt">&lt;/environment&gt;</span>
    <span class="nt">&lt;/environments&gt;</span>
    <span class="nt">&lt;mappers&gt;</span>
        <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">""</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/mappers&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</pre></table></code></div></div><h3 id="创建逆向工程的配置文件">创建逆向工程的配置文件<a href="#创建逆向工程的配置文件" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li>文件名必须是：<code class="language-plaintext highlighter-rouge">generatorConfig.xml</code></ul><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="cp">&lt;!DOCTYPE generatorConfiguration
        PUBLIC "-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN"
        "http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd"&gt;</span>
    <span class="c">&lt;!--
    targetRuntime: 执行生成的逆向工程的版本
    MyBatis3Simple: 生成基本的CRUD（清新简洁版）
    MyBatis3: 生成带条件的CRUD（奢华尊享版）
    --&gt;</span>

<span class="nt">&lt;generatorConfiguration&gt;</span>
    <span class="nt">&lt;context</span> <span class="na">id=</span><span class="s">"DB2Tables"</span> <span class="na">targetRuntime=</span><span class="s">"MyBatis3Simple"</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- 数据库的连接信息 --&gt;</span>
        <span class="nt">&lt;jdbcConnection</span> <span class="na">driverClass=</span><span class="s">"com.mysql.cj.jdbc.Driver"</span>
                        <span class="na">connectionURL=</span><span class="s">"jdbc:mysql://localhost:3306/mybatis"</span>
                        <span class="na">userId=</span><span class="s">"root"</span>
                        <span class="na">password=</span><span class="s">"123456"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/jdbcConnection&gt;</span>
        <span class="c">&lt;!-- javaBean的生成策略--&gt;</span>
        <span class="nt">&lt;javaModelGenerator</span> <span class="na">targetPackage=</span><span class="s">"com.atguigu.mybatis.pojo"</span> <span class="na">targetProject=</span><span class="s">".\src\main\java"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"enableSubPackages"</span> <span class="na">value=</span><span class="s">"true"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"trimStrings"</span> <span class="na">value=</span><span class="s">"true"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/javaModelGenerator&gt;</span>
        <span class="c">&lt;!-- SQL映射文件的生成策略 --&gt;</span>
        <span class="nt">&lt;sqlMapGenerator</span> <span class="na">targetPackage=</span><span class="s">"com.atguigu.mybatis.mapper"</span>
                         <span class="na">targetProject=</span><span class="s">".\src\main\resources"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"enableSubPackages"</span> <span class="na">value=</span><span class="s">"true"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/sqlMapGenerator&gt;</span>
        <span class="c">&lt;!-- Mapper接口的生成策略 --&gt;</span>
        <span class="nt">&lt;javaClientGenerator</span> <span class="na">type=</span><span class="s">"XMLMAPPER"</span>
                             <span class="na">targetPackage=</span><span class="s">"com.atguigu.mybatis.mapper"</span> <span class="na">targetProject=</span><span class="s">".\src\main\java"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"enableSubPackages"</span> <span class="na">value=</span><span class="s">"true"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/javaClientGenerator&gt;</span>
        <span class="c">&lt;!-- 逆向分析的表 --&gt;</span>
        <span class="c">&lt;!-- tableName设置为*号，可以对应所有表，此时不写domainObjectName --&gt;</span>
        <span class="c">&lt;!-- domainObjectName属性指定生成出来的实体类的类名 --&gt;</span>
        <span class="nt">&lt;table</span> <span class="na">tableName=</span><span class="s">"t_emp"</span> <span class="na">domainObjectName=</span><span class="s">"Emp"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;table</span> <span class="na">tableName=</span><span class="s">"t_dept"</span> <span class="na">domainObjectName=</span><span class="s">"Dept"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/context&gt;</span>
<span class="nt">&lt;/generatorConfiguration&gt;</span>
</pre></table></code></div></div><h3 id="执行mbg插件的generate目标">执行MBG插件的generate目标<a href="#执行mbg插件的generate目标" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li><img data-src="https://cdn.jsdelivr.net/gh/Casflawed/img-host@master/blog/202207131322190.png" alt="执行MBG插件的generate目标" data-proofer-ignore><li>如果出现报错：<code class="language-plaintext highlighter-rouge">Exception getting JDBC Driver</code>，可能是pom.xml中，数据库驱动配置错误<ul><li>dependency中的驱动<img data-src="https://cdn.jsdelivr.net/gh/Casflawed/img-host@master/blog/202207131323683.png" alt="dependency中的驱动" data-proofer-ignore><li>mybatis-generator-maven-plugin插件中的驱动<img data-src="https://cdn.jsdelivr.net/gh/Casflawed/img-host@master/blog/202207131324781.png" alt="插件中的驱动" data-proofer-ignore><li>两者的驱动版本应该相同</ul><li>执行结果<img data-src="https://cdn.jsdelivr.net/gh/Casflawed/img-host@master/blog/202207131324568.png" alt="逆向执行结果" data-proofer-ignore></ul><h2 id="qbc">QBC<a href="#qbc" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="查询">查询<a href="#查询" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li><code class="language-plaintext highlighter-rouge">selectByExample</code>：按条件查询，需要传入一个example对象或者null；如果传入一个null，则表示没有条件，也就是查询所有数据<li><code class="language-plaintext highlighter-rouge">example.createCriteria().xxx</code>：创建条件对象，通过andXXX方法为SQL添加查询添加，每个条件之间是and关系<li><code class="language-plaintext highlighter-rouge">example.or().xxx</code>：将之前添加的条件通过or拼接其他条件</ul><p><img data-src="https://cdn.jsdelivr.net/gh/Casflawed/img-host@master/blog/202207131324819.png" alt="example的方法" data-proofer-ignore></p><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="nd">@Test</span> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testMBG</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
	<span class="nc">InputStream</span> <span class="n">is</span> <span class="o">=</span> <span class="nc">Resources</span><span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="s">"mybatis-config.xml"</span><span class="o">);</span>
	<span class="nc">SqlSessionFactoryBuilder</span> <span class="n">sqlSessionFactoryBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SqlSessionFactoryBuilder</span><span class="o">();</span>
	<span class="nc">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span> <span class="o">=</span> <span class="n">sqlSessionFactoryBuilder</span><span class="o">.</span><span class="na">build</span><span class="o">(</span><span class="n">is</span><span class="o">);</span>
	<span class="nc">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
	<span class="nc">EmpMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="nc">EmpMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
	<span class="nc">EmpExample</span> <span class="n">example</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">EmpExample</span><span class="o">();</span>
	<span class="c1">//名字为张三，且年龄大于等于20</span>
	<span class="n">example</span><span class="o">.</span><span class="na">createCriteria</span><span class="o">().</span><span class="na">andEmpNameEqualTo</span><span class="o">(</span><span class="s">"张三"</span><span class="o">).</span><span class="na">andAgeGreaterThanOrEqualTo</span><span class="o">(</span><span class="mi">20</span><span class="o">);</span>
	<span class="c1">//或者did不为空</span>
	<span class="n">example</span><span class="o">.</span><span class="na">or</span><span class="o">().</span><span class="na">andDidIsNotNull</span><span class="o">();</span>
	<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Emp</span><span class="o">&gt;</span> <span class="n">emps</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">selectByExample</span><span class="o">(</span><span class="n">example</span><span class="o">);</span>
	<span class="n">emps</span><span class="o">.</span><span class="na">forEach</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">::</span><span class="n">println</span><span class="o">);</span>
<span class="o">}</span>
</pre></table></code></div></div><p><img data-src="https://cdn.jsdelivr.net/gh/Casflawed/img-host@master/blog/202207131325994.png" alt="example测试结果" data-proofer-ignore></p><h3 id="增改">增改<a href="#增改" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li><code class="language-plaintext highlighter-rouge">updateByPrimaryKey</code>：通过主键进行数据修改，如果某一个值为null，也会将对应的字段改为null<ul><li><code class="language-plaintext highlighter-rouge">mapper.updateByPrimaryKey(new Emp(1,"admin",22,null,"456@qq.com",3));</code><li><img data-src="https://cdn.jsdelivr.net/gh/Casflawed/img-host@master/blog/202207131325316.png" alt="增删改测试结果1" data-proofer-ignore></ul><li><code class="language-plaintext highlighter-rouge">updateByPrimaryKeySelective()</code>：通过主键进行选择性数据修改，如果某个值为null，则不修改这个字段<ul><li><code class="language-plaintext highlighter-rouge">mapper.updateByPrimaryKeySelective(new Emp(2,"admin2",22,null,"456@qq.com",3));</code><li><img data-src="https://cdn.jsdelivr.net/gh/Casflawed/img-host@master/blog/202207131326386.png" alt="增删改测试结果2" data-proofer-ignore></ul></ul><h1 id="分页插件">分页插件</h1><h2 id="分页插件使用步骤">分页插件使用步骤<a href="#分页插件使用步骤" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="添加依赖-1">添加依赖<a href="#添加依赖-1" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c">&lt;!-- https://mvnrepository.com/artifact/com.github.pagehelper/pagehelper --&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
	<span class="nt">&lt;groupId&gt;</span>com.github.pagehelper<span class="nt">&lt;/groupId&gt;</span>
	<span class="nt">&lt;artifactId&gt;</span>pagehelper<span class="nt">&lt;/artifactId&gt;</span>
	<span class="nt">&lt;version&gt;</span>5.2.0<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></table></code></div></div><h3 id="配置分页插件">配置分页插件<a href="#配置分页插件" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li>在MyBatis的核心配置文件（mybatis-config.xml）中配置插件<li><img data-src="https://cdn.jsdelivr.net/gh/Casflawed/img-host@master/blog/202207131326986.png" alt="配置分页插件" data-proofer-ignore></ul><div class="language-xml highlighter-rouge"><div class="code-header"> <span label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nt">&lt;plugins&gt;</span>
	<span class="c">&lt;!--设置分页插件--&gt;</span>
	<span class="nt">&lt;plugin</span> <span class="na">interceptor=</span><span class="s">"com.github.pagehelper.PageInterceptor"</span><span class="nt">&gt;&lt;/plugin&gt;</span>
<span class="nt">&lt;/plugins&gt;</span>
</pre></table></code></div></div><h2 id="分页插件的使用">分页插件的使用<a href="#分页插件的使用" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="开启分页功能">开启分页功能<a href="#开启分页功能" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li>在查询功能之前使用<code class="language-plaintext highlighter-rouge">PageHelper.startPage(int pageNum, int pageSize)</code>开启分页功能<ul><li>pageNum：当前页的页码<li>pageSize：每页显示的条数</ul></ul><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testPageHelper</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
	<span class="nc">InputStream</span> <span class="n">is</span> <span class="o">=</span> <span class="nc">Resources</span><span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="s">"mybatis-config.xml"</span><span class="o">);</span>
	<span class="nc">SqlSessionFactoryBuilder</span> <span class="n">sqlSessionFactoryBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SqlSessionFactoryBuilder</span><span class="o">();</span>
	<span class="nc">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span> <span class="o">=</span> <span class="n">sqlSessionFactoryBuilder</span><span class="o">.</span><span class="na">build</span><span class="o">(</span><span class="n">is</span><span class="o">);</span>
	<span class="nc">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
	<span class="nc">EmpMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="nc">EmpMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
	<span class="c1">//访问第一页，每页四条数据</span>
	<span class="nc">PageHelper</span><span class="o">.</span><span class="na">startPage</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">4</span><span class="o">);</span>
	<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Emp</span><span class="o">&gt;</span> <span class="n">emps</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">selectByExample</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
	<span class="n">emps</span><span class="o">.</span><span class="na">forEach</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">::</span><span class="n">println</span><span class="o">);</span>
<span class="o">}</span>
</pre></table></code></div></div><p><img data-src="https://cdn.jsdelivr.net/gh/Casflawed/img-host@master/blog/202207131326008.png" alt="分页测试结果" data-proofer-ignore></p><h3 id="分页相关数据">分页相关数据<a href="#分页相关数据" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><h4 id="方法一直接输出">方法一：直接输出<a href="#方法一直接输出" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testPageHelper</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
	<span class="nc">InputStream</span> <span class="n">is</span> <span class="o">=</span> <span class="nc">Resources</span><span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="s">"mybatis-config.xml"</span><span class="o">);</span>
	<span class="nc">SqlSessionFactoryBuilder</span> <span class="n">sqlSessionFactoryBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SqlSessionFactoryBuilder</span><span class="o">();</span>
	<span class="nc">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span> <span class="o">=</span> <span class="n">sqlSessionFactoryBuilder</span><span class="o">.</span><span class="na">build</span><span class="o">(</span><span class="n">is</span><span class="o">);</span>
	<span class="nc">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
	<span class="nc">EmpMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="nc">EmpMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
	<span class="c1">//访问第一页，每页四条数据</span>
	<span class="nc">Page</span><span class="o">&lt;</span><span class="nc">Object</span><span class="o">&gt;</span> <span class="n">page</span> <span class="o">=</span> <span class="nc">PageHelper</span><span class="o">.</span><span class="na">startPage</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">4</span><span class="o">);</span>
	<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Emp</span><span class="o">&gt;</span> <span class="n">emps</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">selectByExample</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
	<span class="c1">//在查询到List集合后，打印分页数据</span>
	<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">page</span><span class="o">);</span>
<span class="o">}</span>
</pre></table></code></div></div><ul><li>分页相关数据：</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nc">Page</span><span class="o">{</span><span class="n">count</span><span class="o">=</span><span class="kc">true</span><span class="o">,</span> <span class="n">pageNum</span><span class="o">=</span><span class="mi">1</span><span class="o">,</span> <span class="n">pageSize</span><span class="o">=</span><span class="mi">4</span><span class="o">,</span> <span class="n">startRow</span><span class="o">=</span><span class="mi">0</span><span class="o">,</span> <span class="n">endRow</span><span class="o">=</span><span class="mi">4</span><span class="o">,</span> <span class="n">total</span><span class="o">=</span><span class="mi">8</span><span class="o">,</span> <span class="n">pages</span><span class="o">=</span><span class="mi">2</span><span class="o">,</span> <span class="n">reasonable</span><span class="o">=</span><span class="kc">false</span><span class="o">,</span> <span class="n">pageSizeZero</span><span class="o">=</span><span class="kc">false</span><span class="o">}[</span><span class="nc">Emp</span><span class="o">{</span><span class="n">eid</span><span class="o">=</span><span class="mi">1</span><span class="o">,</span> <span class="n">empName</span><span class="o">=</span><span class="err">'</span><span class="n">admin</span><span class="err">'</span><span class="o">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">22</span><span class="o">,</span> <span class="n">sex</span><span class="o">=</span><span class="sc">'男'</span><span class="o">,</span> <span class="n">email</span><span class="o">=</span><span class="err">'</span><span class="mi">456</span><span class="nd">@qq</span><span class="o">.</span><span class="na">com</span><span class="err">'</span><span class="o">,</span> <span class="n">did</span><span class="o">=</span><span class="mi">3</span><span class="o">},</span> <span class="nc">Emp</span><span class="o">{</span><span class="n">eid</span><span class="o">=</span><span class="mi">2</span><span class="o">,</span> <span class="n">empName</span><span class="o">=</span><span class="err">'</span><span class="n">admin2</span><span class="err">'</span><span class="o">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">22</span><span class="o">,</span> <span class="n">sex</span><span class="o">=</span><span class="sc">'男'</span><span class="o">,</span> <span class="n">email</span><span class="o">=</span><span class="err">'</span><span class="mi">456</span><span class="nd">@qq</span><span class="o">.</span><span class="na">com</span><span class="err">'</span><span class="o">,</span> <span class="n">did</span><span class="o">=</span><span class="mi">3</span><span class="o">},</span> <span class="nc">Emp</span><span class="o">{</span><span class="n">eid</span><span class="o">=</span><span class="mi">3</span><span class="o">,</span> <span class="n">empName</span><span class="o">=</span><span class="err">'</span><span class="n">王五</span><span class="err">'</span><span class="o">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">12</span><span class="o">,</span> <span class="n">sex</span><span class="o">=</span><span class="sc">'女'</span><span class="o">,</span> <span class="n">email</span><span class="o">=</span><span class="err">'</span><span class="mi">123</span><span class="nd">@qq</span><span class="o">.</span><span class="na">com</span><span class="err">'</span><span class="o">,</span> <span class="n">did</span><span class="o">=</span><span class="mi">3</span><span class="o">},</span> <span class="nc">Emp</span><span class="o">{</span><span class="n">eid</span><span class="o">=</span><span class="mi">4</span><span class="o">,</span> <span class="n">empName</span><span class="o">=</span><span class="err">'</span><span class="n">赵六</span><span class="err">'</span><span class="o">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="o">,</span> <span class="n">sex</span><span class="o">=</span><span class="sc">'男'</span><span class="o">,</span> <span class="n">email</span><span class="o">=</span><span class="err">'</span><span class="mi">123</span><span class="nd">@qq</span><span class="o">.</span><span class="na">com</span><span class="err">'</span><span class="o">,</span> <span class="n">did</span><span class="o">=</span><span class="mi">1</span><span class="o">}]</span>
</pre></table></code></div></div><h4 id="方法二使用pageinfo">方法二使用PageInfo<a href="#方法二使用pageinfo" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><ul><li>在查询获取list集合之后，使用<code class="language-plaintext highlighter-rouge">PageInfo&lt;T&gt; pageInfo = new PageInfo&lt;&gt;(List&lt;T&gt; list, intnavigatePages)</code>获取分页相关数据<ul><li>list：分页之后的数据<li>navigatePages：导航分页的页码数</ul></ul><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testPageHelper</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
	<span class="nc">InputStream</span> <span class="n">is</span> <span class="o">=</span> <span class="nc">Resources</span><span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="s">"mybatis-config.xml"</span><span class="o">);</span>
	<span class="nc">SqlSessionFactoryBuilder</span> <span class="n">sqlSessionFactoryBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SqlSessionFactoryBuilder</span><span class="o">();</span>
	<span class="nc">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span> <span class="o">=</span> <span class="n">sqlSessionFactoryBuilder</span><span class="o">.</span><span class="na">build</span><span class="o">(</span><span class="n">is</span><span class="o">);</span>
	<span class="nc">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
	<span class="nc">EmpMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="nc">EmpMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
	<span class="nc">PageHelper</span><span class="o">.</span><span class="na">startPage</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">4</span><span class="o">);</span>
	<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Emp</span><span class="o">&gt;</span> <span class="n">emps</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">selectByExample</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
	<span class="nc">PageInfo</span><span class="o">&lt;</span><span class="nc">Emp</span><span class="o">&gt;</span> <span class="n">page</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PageInfo</span><span class="o">&lt;&gt;(</span><span class="n">emps</span><span class="o">,</span><span class="mi">5</span><span class="o">);</span>
	<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">page</span><span class="o">);</span>
<span class="o">}</span>
</pre></table></code></div></div><ul><li>分页相关数据：</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nc">PageInfo</span><span class="o">{</span>
<span class="n">pageNum</span><span class="o">=</span><span class="mi">1</span><span class="o">,</span> <span class="n">pageSize</span><span class="o">=</span><span class="mi">4</span><span class="o">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="o">,</span> <span class="n">startRow</span><span class="o">=</span><span class="mi">1</span><span class="o">,</span> <span class="n">endRow</span><span class="o">=</span><span class="mi">4</span><span class="o">,</span> <span class="n">total</span><span class="o">=</span><span class="mi">8</span><span class="o">,</span> <span class="n">pages</span><span class="o">=</span><span class="mi">2</span><span class="o">,</span> 
<span class="n">list</span><span class="o">=</span><span class="nc">Page</span><span class="o">{</span><span class="n">count</span><span class="o">=</span><span class="kc">true</span><span class="o">,</span> <span class="n">pageNum</span><span class="o">=</span><span class="mi">1</span><span class="o">,</span> <span class="n">pageSize</span><span class="o">=</span><span class="mi">4</span><span class="o">,</span> <span class="n">startRow</span><span class="o">=</span><span class="mi">0</span><span class="o">,</span> <span class="n">endRow</span><span class="o">=</span><span class="mi">4</span><span class="o">,</span> <span class="n">total</span><span class="o">=</span><span class="mi">8</span><span class="o">,</span> <span class="n">pages</span><span class="o">=</span><span class="mi">2</span><span class="o">,</span> <span class="n">reasonable</span><span class="o">=</span><span class="kc">false</span><span class="o">,</span> <span class="n">pageSizeZero</span><span class="o">=</span><span class="kc">false</span><span class="o">}[</span><span class="nc">Emp</span><span class="o">{</span><span class="n">eid</span><span class="o">=</span><span class="mi">1</span><span class="o">,</span> <span class="n">empName</span><span class="o">=</span><span class="err">'</span><span class="n">admin</span><span class="err">'</span><span class="o">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">22</span><span class="o">,</span> <span class="n">sex</span><span class="o">=</span><span class="sc">'男'</span><span class="o">,</span> <span class="n">email</span><span class="o">=</span><span class="err">'</span><span class="mi">456</span><span class="nd">@qq</span><span class="o">.</span><span class="na">com</span><span class="err">'</span><span class="o">,</span> <span class="n">did</span><span class="o">=</span><span class="mi">3</span><span class="o">},</span> <span class="nc">Emp</span><span class="o">{</span><span class="n">eid</span><span class="o">=</span><span class="mi">2</span><span class="o">,</span> <span class="n">empName</span><span class="o">=</span><span class="err">'</span><span class="n">admin2</span><span class="err">'</span><span class="o">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">22</span><span class="o">,</span> <span class="n">sex</span><span class="o">=</span><span class="sc">'男'</span><span class="o">,</span> <span class="n">email</span><span class="o">=</span><span class="err">'</span><span class="mi">456</span><span class="nd">@qq</span><span class="o">.</span><span class="na">com</span><span class="err">'</span><span class="o">,</span> <span class="n">did</span><span class="o">=</span><span class="mi">3</span><span class="o">},</span> <span class="nc">Emp</span><span class="o">{</span><span class="n">eid</span><span class="o">=</span><span class="mi">3</span><span class="o">,</span> <span class="n">empName</span><span class="o">=</span><span class="err">'</span><span class="n">王五</span><span class="err">'</span><span class="o">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">12</span><span class="o">,</span> <span class="n">sex</span><span class="o">=</span><span class="sc">'女'</span><span class="o">,</span> <span class="n">email</span><span class="o">=</span><span class="err">'</span><span class="mi">123</span><span class="nd">@qq</span><span class="o">.</span><span class="na">com</span><span class="err">'</span><span class="o">,</span> <span class="n">did</span><span class="o">=</span><span class="mi">3</span><span class="o">},</span> <span class="nc">Emp</span><span class="o">{</span><span class="n">eid</span><span class="o">=</span><span class="mi">4</span><span class="o">,</span> <span class="n">empName</span><span class="o">=</span><span class="err">'</span><span class="n">赵六</span><span class="err">'</span><span class="o">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="o">,</span> <span class="n">sex</span><span class="o">=</span><span class="sc">'男'</span><span class="o">,</span> <span class="n">email</span><span class="o">=</span><span class="err">'</span><span class="mi">123</span><span class="nd">@qq</span><span class="o">.</span><span class="na">com</span><span class="err">'</span><span class="o">,</span> <span class="n">did</span><span class="o">=</span><span class="mi">1</span><span class="o">}],</span> 
<span class="n">prePage</span><span class="o">=</span><span class="mi">0</span><span class="o">,</span> <span class="n">nextPage</span><span class="o">=</span><span class="mi">2</span><span class="o">,</span> <span class="n">isFirstPage</span><span class="o">=</span><span class="kc">true</span><span class="o">,</span> <span class="n">isLastPage</span><span class="o">=</span><span class="kc">false</span><span class="o">,</span> <span class="n">hasPreviousPage</span><span class="o">=</span><span class="kc">false</span><span class="o">,</span> <span class="n">hasNextPage</span><span class="o">=</span><span class="kc">true</span><span class="o">,</span> <span class="n">navigatePages</span><span class="o">=</span><span class="mi">5</span><span class="o">,</span> <span class="n">navigateFirstPage</span><span class="o">=</span><span class="mi">1</span><span class="o">,</span> <span class="n">navigateLastPage</span><span class="o">=</span><span class="mi">2</span><span class="o">,</span> <span class="n">navigatepageNums</span><span class="o">=[</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">]}</span>
</pre></table></code></div></div><ul><li>其中list中的数据等同于方法一中直接输出的page数据</ul><h4 id="常用数据">常用数据：<a href="#常用数据" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><ul><li>pageNum：当前页的页码<li>pageSize：每页显示的条数<li>size：当前页显示的真实条数<li>total：总记录数<li>pages：总页数<li>prePage：上一页的页码<li>nextPage：下一页的页码<li>isFirstPage/isLastPage：是否为第一页/最后一页<li>hasPreviousPage/hasNextPage：是否存在上一页/下一页<li>navigatePages：导航分页的页码数<li>navigatepageNums：导航分页的页码，[1,2,3,4,5]</ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/%E6%A1%86%E6%9E%B6/'>框架</a>, <a href='/categories/mybatis/'>MyBatis</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> 本文由作者按照 <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> 进行授权</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">分享</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=MyBatis - flameking&url=https://casflawed.github.io/posts/MyBatis/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=MyBatis - flameking&u=https://casflawed.github.io/posts/MyBatis/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=MyBatis - flameking&url=https://casflawed.github.io/posts/MyBatis/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="分享链接" title-succeed="链接已复制！"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">最近更新</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/%E7%A7%AF%E5%88%86%E4%BD%93%E7%B3%BB%E8%AE%BE%E8%AE%A1/">积分体系设计</a><li><a href="/posts/%E6%94%AF%E4%BB%98%E5%AE%9D%E6%94%AF%E4%BB%98%E5%8A%9F%E8%83%BD%E5%AE%9E%E8%B7%B5/">支付宝支付功能实践</a><li><a href="/posts/%E5%88%86%E5%B8%83%E5%BC%8F%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0/">分布式定时任务功能实现</a><li><a href="/posts/%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/">代理模式</a><li><a href="/posts/Spring-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86/">Spring 事务管理</a></ul></div><div id="access-tags"><div class="panel-heading">热门标签</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/%E6%B3%A8%E8%A7%A3/">注解</a> <a class="post-tag" href="/tags/%E5%8F%8D%E5%B0%84/">反射</a> <a class="post-tag" href="/tags/%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1/">系统设计</a> <a class="post-tag" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">设计模式</a> <a class="post-tag" href="/tags/%E5%B0%81%E8%A3%85/">封装</a> <a class="post-tag" href="/tags/cglib/">CGLIB</a> <a class="post-tag" href="/tags/lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F/">lambda表达式</a> <a class="post-tag" href="/tags/litepal/">litepal</a> <a class="post-tag" href="/tags/springboot/">SpringBoot</a> <a class="post-tag" href="/tags/%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/">二分查找</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">文章内容</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>相关文章</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/mybatis%E4%B8%AD%E5%9B%9B%E7%A7%8D%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2%E7%9A%84%E6%96%B9%E5%BC%8F/"><div class="card-body"> <em class="timeago small" date="2022-10-18 00:00:00 +0800" >2022-10-18</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>MyBatis中四种模糊查询的方式</h3><div class="text-muted small"><p> mybatis的模糊查询 方式一： 手动添加”%”通配符 xml配置： 1 2 3 4 &amp;lt;!--模糊查询--&amp;gt; &amp;lt;select id=&quot;fuzzyQuery&quot; resultType=&quot;com.bin.pojo.Book&quot;&amp;gt; select * from mybatis.book where bookName like #{info}; &amp;...</p></div></div></a></div><div class="card"> <a href="/posts/MyBatis%E6%95%B4%E5%90%88%E4%B8%8E%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/"><div class="card-body"> <em class="timeago small" date="2022-06-06 00:00:00 +0800" >2022-06-06</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>MyBatis整合与逆向工程</h3><div class="text-muted small"><p> MyBatis基本的使用方法 1.新建Maven工程 2.导入MyBatis依赖 &amp;lt;dependencies&amp;gt; &amp;lt;!-- Junit测试框架，用作方法测试 --&amp;gt; &amp;lt;dependency&amp;gt; &amp;lt;groupId&amp;gt;junit&amp;lt;/groupId&amp;gt; &amp;lt;artifactId&amp;gt;junit...</p></div></div></a></div><div class="card"> <a href="/posts/SpringMVC/"><div class="card-body"> <em class="timeago small" date="2022-07-12 00:00:00 +0800" >2022-07-12</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>SpringMVC</h3><div class="text-muted small"><p> 一、SpringMVC简介 1、什么是MVC MVC是一种软件架构的思想，将软件按照模型、视图、控制器来划分 M：Model，模型层，指工程中的JavaBean，作用是处理数据 JavaBean分为两类： 一类称为实体类Bean：专门存储业务数据的，如 Student、User 等 一类称为业务处理 Bean：指 Service 或 Dao 对象，专门用于处理业务逻辑和数...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/SpringMVC/" class="btn btn-outline-primary" prompt="上一篇"><p>SpringMVC</p></a> <a href="/posts/SpringBoot2%E5%9F%BA%E7%A1%80%E7%AF%87/" class="btn btn-outline-primary" prompt="下一篇"><p>SpringBoot2基础篇</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/Casflawed">flameking</a>. <span data-toggle="tooltip" data-placement="top" title="除非另有说明，本网站上的博客文章均由作者按照知识共享署名 4.0 国际 (CC BY 4.0) 许可协议进行授权。">保留部分权利。</span></p></div><div class="footer-right"><p class="mb-0"> 本站由 <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> 生成，采用 <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> 主题。</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">热门标签</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/%E6%B3%A8%E8%A7%A3/">注解</a> <a class="post-tag" href="/tags/%E5%8F%8D%E5%B0%84/">反射</a> <a class="post-tag" href="/tags/%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1/">系统设计</a> <a class="post-tag" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">设计模式</a> <a class="post-tag" href="/tags/%E5%B0%81%E8%A3%85/">封装</a> <a class="post-tag" href="/tags/cglib/">CGLIB</a> <a class="post-tag" href="/tags/lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F/">lambda表达式</a> <a class="post-tag" href="/tags/litepal/">litepal</a> <a class="post-tag" href="/tags/springboot/">SpringBoot</a> <a class="post-tag" href="/tags/%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/">二分查找</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">搜索结果为空</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
