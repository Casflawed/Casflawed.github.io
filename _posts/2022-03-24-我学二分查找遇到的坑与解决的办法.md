---
title: æˆ‘å­¦äºŒåˆ†æŸ¥æ‰¾é‡åˆ°çš„å‘ä¸è§£å†³çš„åŠæ³•
date: 2022-03-24 +/-TTTT
categories: [ç®—æ³•ä¸æ•°æ®ç»“æ„,ç®—æ³•,äºŒåˆ†æŸ¥æ‰¾]
tags: [äºŒåˆ†æŸ¥æ‰¾]     # TAG names should always be lowercase
---
## å‰è¨€
> æœ¬æ–‡èšç„¦æœ€ç®€å•çš„äºŒåˆ†æŸ¥æ‰¾ï¼Œé›†ä¸­è®¨è®ºé‚£äº›æˆ‘ä»¬ä¸æ›¾æ³¨æ„çš„é—®é¢˜ï¼Œè§£å¼€äºŒåˆ†æŸ¥æ‰¾ä¸ç®€å•çš„ä¸€é¢ï¼Œåœ¨æœ¬æ–‡ä¸­ç¬”è€…å°†å¸¦ä½ é‡æ–°è®¤è¯†äºŒåˆ†æŸ¥æ‰¾

## å¼•å­
> æœ‰æ•°é‡ä¸ºnçš„ç¡¬å¸ï¼Œå’Œä¸€ä¸ªå¤©å¹³ï¼Œå·²çŸ¥å…¶ä¸­æœ‰ä¸€ä¸ªå‡å¸ï¼Œä¸”å‡å¸æ¯”çœŸå¸è½»ï¼Œè¯·æ‰¾å‡ºè¿™æšå‡å¸

æˆ‘è®°å¾—è¿™ç§é¢˜ç›®æ˜¯åœ¨æˆ‘å°å­¦é‡åˆ°è¿‡çš„ï¼Œé‚£æ—¶å€™è™½ç„¶ä¸çŸ¥é“ä»€ä¹ˆäºŒåˆ†æŸ¥æ‰¾æ³•ï¼Œä½†è„‘è¢‹ä¸€åè‡ªç„¶ä¹Ÿèƒ½æƒ³åˆ°ï¼šæŠŠç¡¬å¸ä¸¤åŠåˆ†ï¼Œå‡å¸å°±åœ¨è½»çš„ä¸€å †ï¼Œç„¶åä¸æ–­çš„åˆ†æˆå‡åŒ€çš„ä¸¤å †ï¼Œæœ€åæ€»èƒ½æ‰¾å‡ºå‡å¸ï¼Œè¿™ä¹ˆçœ‹æ¥äºŒåˆ†æŸ¥æ‰¾ä¼¼ä¹æ˜¯ä¸€ç§å¾ˆå¸¸è¯†çš„ä¸œè¥¿ï¼Œå¯¹ï¼å®ƒç¡®å®ç®€å•ï¼Œå¦‚æœè¦ä¸€ä¸ªäººæ‰‹å†™å¿«æ’ï¼Œä»–å¯èƒ½ä¸ä¸€å®šèƒ½å†™å¾—å‡ºæ¥ï¼Œä½†è¦ä»–å†™äºŒåˆ†æŸ¥æ‰¾ï¼Œé‚£ä»–è‚¯å®šè¡Œï¼ä¸‹é¢æ˜¯å¸¸è§çš„ä¸€ç§äºŒåˆ†æŸ¥æ‰¾çš„ demoï¼š

```java
public int search(int[] arr, int target){
        int left = 0, right = arr.length-1;
        while (left <= right){
            int mid = left+(right-left>>1);
            if (target == arr[mid]){
                return mid;
            }else if (target > arr[mid]){
                left = mid+1;
            }else if (target < arr[mid]){
                right = mid-1;
            }
        }
        return -1;
    }
```

æˆ‘å°±ç»å¸¸è¿™æ ·å†™ï¼Œä¸è¿‡æ¯æ¬¡æˆ‘éƒ½æœ‰å‡ ä¸ªåœ°æ–¹æ‹¿ä¸å‡†ï¼š

> é—®é¢˜1. `right = arr.length - 1` or `right = arr.length`
> é—®é¢˜2. `while (left < right)` or `while (left <= right)`
> é—®é¢˜3. `mid = (left + right) / 2`ï¼Œ`mid = (left + right) >> 1` or `mid = left + (right - left) / 2`ï¼Œè¿™ä¸‰ç§å†™æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ
> é—®é¢˜4. `mid = left + (right - left ) / 2` or `mid = left + (right - left + 1) / 2`
> é—®é¢˜5. `left = mid + 1` or `left = mid`ï¼Œ`right = mid - 1` or `right = mid`

ğŸ˜®æ¬¸ï¼Ÿè¢«æˆ‘è¿™ä¹ˆä¸€æï¼Œä½ æ˜¯ä¸æ˜¯ä¹Ÿå‘ç°äº‹æƒ…å¥½åƒæ ¹æœ¬æ²¡é‚£ä¹ˆç®€å•ï¼Ÿï¼ğŸ˜®

ğŸ˜æ²¡äº‹ï¼Œä¸‹é¢è·Ÿç€ç¬”è€…ä¸€èµ·æ¥æ¢è®¨ï¼Œçœ‹çœ‹è¿™äºŒåˆ†æŸ¥æ‰¾åˆ°åº•æ˜¯ä¸ªä»€ä¹ˆå¦–æ€ªï¼ŸğŸ˜

## æ¦‚å¿µé¡»çŸ¥
### æœç´¢åŒºé—´
å¯ä»¥è¯´åšäºŒåˆ†æŸ¥æ‰¾è¿™ç±»çš„é¢˜ç›®ä¸€å®šè¦æœ‰åŒºé—´çš„æ¦‚å¿µï¼Œæ‰€è°“çš„æœç´ åŒºé—´å°±æ˜¯æˆ‘ä»¬æŒ‡å®šçš„æŸ¥æ‰¾èŒƒå›´ï¼Œä¹Ÿå°±æ˜¯ left å’Œ right ä¹‹é—´çš„è¿™æ®µã€‚è€Œä¸”éšç€æˆ‘ä»¬ä¸åœçš„äºŒåˆ†ï¼Œ<font color="red">æœç´¢åŒºé—´å°†ä¼šè¢«ä¸æ–­åˆ†å‰²å¹¶ç¼©å°</font>ç›´åˆ°æ‰¾å‡ºç›®æ ‡æ•°æ®æˆ–è€…æœç´¢åŒºé—´ä¸ºç©ºã€‚**è¿™é‡Œå…ˆæä¸€ä¸‹ï¼šä¸€å®šè¦è®©ä½ çš„æœç´¢åŒºé—´èƒ½å¤Ÿæ­£å¸¸ç¼©å°ï¼Œå¦åˆ™ä¼šäº§ç”Ÿä¸¥é‡çš„é—®é¢˜ï¼**

### åˆ¤ç©ºæ¡ä»¶
ä¹Ÿå°±æ˜¯ while é‡Œé¢çš„æ¡ä»¶åˆ¤æ–­ï¼Œå½“==æœç´¢åŒºé—´ä¸ºç©º==æ—¶å¾ªç¯è·³å‡ºï¼Œå¯¹äºä¸åŒçš„åˆ¤ç©ºæ¡ä»¶æœ‰ä»¥ä¸‹ä¸‰ç§æƒ…å†µï¼š

1. while(left <= right)
	left == right+1ï¼Œè·³å‡ºå¾ªç¯ï¼Œæ­¤ç§æƒ…å†µä¸‹å·¦å³è¾¹ç•Œå€¼ä¹Ÿä¼šè¢«å–åˆ°ï¼Œæœç´¢åŒºé—´ç›¸å½“äº [leftï¼Œright]
2. while(left < right)
	left == rightï¼Œå¾ªç¯è·³å‡ºï¼Œæœç´¢åŒºé—´ç›¸å½“äº [leftï¼Œright)
3. while(left < right-1)
	left == right-1ï¼Œå¾ªç¯è·³å‡ºï¼Œæœç´¢åŒºé—´ç›¸å½“äº [leftï¼Œright-1)ï¼Œè¿™ä¸ªæƒ…å†µå…¶å®æ˜¯æˆ‘æ€»ç»“å‡ºæ¥çš„ä¸€ç§æŠ€å·§ï¼Œå¯¹è§£å†³ä¸€ç§é—®é¢˜éå¸¸æœ‰ç”¨ï¼Œåœ¨è¿™å®¹è®¸ç¬”è€…å…ˆå–ä¸ªå…³å­ï¼Œåç»­ä¼šä¸ºä½ æ­æ™“
	
ä»è¿™å‡ ç§æƒ…å†µæ¥çœ‹ï¼Œåˆ¤ç©ºæ¡ä»¶å†³å®šäº†æ¯æ¬¡ä½ è¿›è¡Œæœç´¢çš„æœ‰æ•ˆåŒºé—´ï¼Œè¯·çœ‹ä¸‹é¢ï¼š

| åˆ¤ç©ºæ¡ä»¶ | æœç´¢åŒºé—´ |
| --- | --- |
| while(left <= right) | [leftï¼Œright] |
| while(left < right) | [leftï¼Œright) |
| while(left < right-1) | [leftï¼Œright-1) |

### å‘ä¸‹å–æ•´ã€å‘é›¶å–æ•´

| æ•´æ•°é™¤æ³• / | å³ç§»è¿ç®— >> |
| -- | -- |
| å‘é›¶å–æ•´| å‘ä¸‹å–æ•´|

ä¾‹å¦‚ï¼š```(-4-5) Ã· 2 = -4.5```ï¼Œå‘é›¶å–æ•´ç­‰äº-4ï¼Œå‘ä¸‹å–æ•´ç­‰äº-5

`éªŒè¯ï¼š`
```java
System.out.printf("æ•´æ•°é™¤æ³•%dï¼Œå³ç§»è¿ç®—%d",(-4-5)/2, (-4-5)>>1);
```
`æµ‹è¯•ç»“æœï¼š`
```
æ•´æ•°é™¤æ³•-4ï¼Œå³ç§»è¿ç®—-5
```

## å¦‚ä½•æ­£ç¡®çš„æ­é…
å›åˆ°æˆ‘ä»¬æ–‡ç« å¼€å¤´æœ€åˆçš„å†™æ³•ï¼Œè¯·ç¨ç¨æ€è€ƒä¸‹é¢çš„é—®é¢˜ï¼š

1. ä¸€å®šè¦è¿™ä¹ˆå†™å—ï¼Ÿ
2. æˆ‘å¯ä»¥éšæ„ç»„åˆå—ï¼Ÿ
3. éšæ„ç»„åˆåå¯èƒ½ä¼šå‡ºç°ä»€ä¹ˆé—®é¢˜ï¼Ÿ

```java
public int search(int[] arr, int target){
        int left = 0, right = arr.length-1;
        while (left <= right){
            int mid = left+(right-left>>1);
            if (target == arr[mid]){
                return mid;
            }else if (target > arr[mid]){
                left = mid+1;
            }else if (target < arr[mid]){
                right = mid-1;
            }
        }
        return -1;
    }
```

> è¿™æ®µç¨‹åºæ˜¯ä¸ºäº†åœ¨ä¸€ä¸ªç»™å‡ºçš„æœç´¢åŒºé—´ä¸­æ‰¾å‡ºç›®æ ‡æ•°æ®ï¼Œä¸‹é¢æˆ‘ä»¬ä»å¤´è‡³å°¾åˆ†æï¼š

1. ä¸ºä»€ä¹ˆæ˜¯ `left <= right`
å‰é¢å·²ç»è¯´äº†ï¼Œåˆ¤ç©ºæ¡ä»¶å†³å®šäº†ä½ çš„æœç´¢åŒºé—´ï¼Œä¹Ÿå°±æ˜¯æ­¤æ—¶æˆ‘ä»¬çš„æœç´¢åŒºé—´æ˜¯ `[0ï¼Œarr.length-1]`ï¼Œå‡è®¾ä½ è¦é€‰æ‹©å·¦é—­å³å¼€çš„æœç´¢åŒºé—´ï¼Œä¹Ÿå°±æ˜¯`[0ï¼Œarr.length-1)`ï¼Œé‚£ä¹ˆå½“æœç´¢åŒºé—´ç¼©å°è‡³ `[arr.length-1ï¼Œarr.length-1)` æ—¶ï¼Œå¾ªç¯è·³å‡ºï¼Œä½†æœ‰æ•ˆæ•°æ® arr[arr.length-1] è¿˜æ²¡æ¥å¾—åŠä¸ target è¿›è¡Œæ¯”è¾ƒï¼Œæ˜¾ç„¶è¿™æ ·çš„ç¨‹åºå­˜åœ¨éšæ‚£ï¼Œå®ƒå¹¶ä¸å®Œç¾ã€‚æ‰€ä»¥ä½ å¯ä»¥é€‰æ‹©ä¿®æ”¹åˆ¤ç©ºæ¡ä»¶ä¸º left <= rightï¼Œä½†ä½ ä¹Ÿå¯ä»¥é€‰æ‹©åŠ ä¸ªè¡¥ä¸ï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼š

```java
public class BinarySearch {
    public int search(int[] arr, int target){
        int left = 0, right = arr.length-1;
        while (left < right){
            int mid = left+(right-left>>1);
            if (target == arr[mid]){
                return mid;
            }else if (target > arr[mid]){
                left = mid+1;
            }else if (target < arr[mid]){
                right = mid-1;
            }
        }
// è¡¥ä¸ï¼šé˜²æ­¢å¿½ç•¥æœ¬è¯¥æ¯”è¾ƒçš„æ•°æ®
        if (arr[left] == target)
            return left;
        return -1;
    }
}
public class BinarySearchTest {
    public static void main(String[] args) {
        int[] nums = {9, 13, 17, 19, 25};
        int[] target = {7, 9, 10, 13, 17, 19, 22, 25, 28};
        BinarySearch binarySearch = new BinarySearch();
        for (int i=0; i<target.length; ++i){
            System.out.println("indexï¼š" + binarySearch.search(nums, target[i]));
        }
    }
}
```

æµ‹è¯•ç»“æœ

```java
indexï¼š-1
indexï¼š0
indexï¼š-1
indexï¼š1
indexï¼š2
indexï¼š3
indexï¼š-1
indexï¼š4
indexï¼š-1
```

2. ä¸ºä»€ä¹ˆæ˜¯ mid = left+(right-left>>1) ï¼Œmid = left+(right-left+1>>1) å¯ä»¥å—ï¼Ÿ

- `>>` ä¸ `/` åªåœ¨æ•°å€¼ä¸ºè´Ÿå€¼æ—¶ä¼šæœ‰åŒºåˆ«ï¼Œæ­£æ•°å¹¶æ²¡æœ‰åŒºåˆ«
- left+(right-left) èƒ½åœ¨ä¸€å®šç¨‹åº¦ä¸Šé¿å…å›  (left+right) è¿‡å¤§è€Œå¯¼è‡´çš„æ•°å€¼æº¢å‡º
- å½“ right-left = 1 æ—¶ï¼Œleft+(right-left >> 1) = leftï¼Œleft+(right-left+1 >> 1) = rightï¼Œä¸‹é¢ç¬”è€…å°†ç»™å‡ºä¸€ä¸ªç¤ºä¾‹å‘Šè¯‰ä½ åè€…çš„å±é™©åœ¨å“ªï¼Ÿ

```java
public class BinarySearch {
    public int search(int[] arr, int target){
        int left = 0, right = arr.length-1;
        while (left < right){
            int mid = left+(right-left+1>>1);
            if (target == arr[mid]){
                return mid;
            }else if (target > arr[mid]){
                left = mid+1;
            }else if (target < arr[mid]){
                right = mid-1;
            }
        }
        // è¡¥ä¸ï¼šé˜²æ­¢å¿½ç•¥æœ¬è¯¥æ¯”è¾ƒçš„æ•°æ®
        if (arr[left] == target)
            return left;
        return -1;
    }
}
public class BinarySearchTest {
    public static void main(String[] args) {
        int[] nums = {19, 25};
        int[] target = {28};
        BinarySearch binarySearch = new BinarySearch();
        for (int i=0; i<target.length; ++i){
            System.out.println("indexï¼š" + binarySearch.search(nums, target[i]));
        }
    }
}
```

æµ‹è¯•ç»“æœï¼š
```java
Exception in thread "main" java.lang.ArrayIndexOutOfBoundsException: Index 2 out of bounds for length 2
	at cn.edu.huas.st.flameking.binarysearch.BinarySearch.search(BinarySearch.java:19)
	at cn.edu.huas.st.flameking.binarysearch.BinarySearchTest.main(BinarySearchTest.java:15)
```

æ˜¾ç„¶å‘ç”Ÿäº†æ•°ç»„è¶Šç•Œï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹å“ªä¸ªåœ°æ–¹å‡ºé”™äº†ï¼š

![æ•°ç»„è¶Šç•Œ](/blog/202203241728189.jpg)
å¯è§åœ¨ç¬¬ä¸€è½®å¾ªç¯ä¸­ï¼Œleft = mid+1 = 2ï¼Œå·²ç»è¶…å‡ºäº†æ•°ç»„çš„æœ‰æ•ˆè®¿é—®èŒƒå›´ã€‚é‚£ä¹ˆè¯¥å¦‚ä½•è§£å†³å‘¢ï¼Ÿç¬¬ä¸€ã€å¦‚æºç¨‹åºæ‰€ç¤ºï¼šleft = mid+1ï¼Œright = mid-1ï¼Œå› æ­¤==åŒºé—´çš„åˆ†å‰²å’Œç¼©å°==å¹¶æ²¡æœ‰é—®é¢˜ï¼Œç¬¬äºŒã€åˆ¤ç©ºæ¡ä»¶äº§ç”Ÿçš„==æœ‰æ•ˆæ•°æ®å¿½ç•¥æ¯”è¾ƒçš„é—®é¢˜==ä¹Ÿå› ä¸ºæ‰“ä¸Šäº†è¡¥ä¸å¾—åˆ°äº†è§£å†³ï¼Œé‚£ä¹ˆæˆ‘ä»¬å†å¯¹æ•°ç»„è¶Šç•Œäº§ç”Ÿçš„é—®é¢˜æ‰“ä¸ªè¡¥ä¸ä¸å°±è¡Œäº†ï¼Œå¦‚ä¸‹ï¼š

```java
public class BinarySearch {
    public int search(int[] arr, int target){
        int left = 0, right = arr.length-1;
        while (left < right){
            int mid = left+(right-left+1>>1);
            if (target == arr[mid]){
                return mid;
            }else if (target > arr[mid]){
                left = mid+1;
            }else if (target < arr[mid]){
                right = mid-1;
            }
        }
// è¡¥ä¸ï¼šå¯¹æ•°ç»„è¶Šç•Œåšå‡ºååº”        
        if (left >= arr.length)
            return -1;
// è¡¥ä¸ï¼šé˜²æ­¢å¿½ç•¥æœ¬è¯¥æ¯”è¾ƒçš„æ•°æ®        
        if (arr[left] == target)
            return left;
        return -1;
    }
}
```

è¯»è€…å¯ä»¥åˆ©ç”¨ä¸Šé¢ç»™å‡ºçš„æµ‹è¯•æ•°æ®è¿›è¡Œæµ‹è¯•ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥è‡ªå·±è®¾è®¡æµ‹è¯•æ•°æ®è¿›è¡ŒéªŒè¯ã€‚

3. ä¸ºä»€ä¹ˆæ˜¯ left = mid+1ï¼Œright = mid-1

åœ¨åˆ¤ç©ºæ¡ä»¶çš„çº¦æŸä¸‹æˆ‘ä»¬çš„å®é™…æœç´¢åŒºé—´æ˜¯[leftï¼Œright]ï¼Œå¯¹äºä¸åˆæ ¼çš„midåº”å½“æŠ›å¼ƒï¼Œå¦‚æœleft = mid æˆ–è€… right = mid æŠ‘æˆ–æ˜¯å·¦å³è¾¹ç•Œå‡æ²¡æœ‰æ­£å¸¸å–èˆï¼Œå°±ä¼šå¯¼è‡´<strong><font color="red" size=4>åŒºé—´ä¸æ­£å¸¸åˆ†å‰²è€Œè¾¾ä¸åˆ°ç¼©å°çš„ç›®çš„</font></strong>ï¼Œè¿™æ ·ä¼šé™·å…¥ä¸€ç§å¾ˆä¸¥é‡çš„é”™è¯¯ï¼šæ­»å¾ªç¯ã€‚é‚£ä¹ˆè¯¥å¦‚ä½•è§£å†³å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œè®©åŒºé—´èƒ½å¤Ÿæ­£å¸¸ç¼©å°å°±è¡Œäº†ã€‚ä¸‹é¢å¯¹ä¸‰ç§æƒ…å†µä¾æ¬¡è¿›è¡Œè§£å†³ï¼š

```java
public class BinarySearch {
    /**
     * left = mid
     * @param arr
     * @param target
     * @return
     */
    public int search(int[] arr, int target){
        int left = 0, right = arr.length-1;
// 3. é¿å…å·¦å³è¾¹ç•Œç›¸ç­‰ä½†æ²¡æœ‰æ‰¾å‡ºç›®æ ‡ï¼Œå¹¶ç”±äºå·¦è¾¹ç•Œä¸æ­£å¸¸åˆ†å‰²å¯¼è‡´æ­»å¾ªç¯ï¼Œæ‰€ä»¥è¦åœ¨ left=right çš„æ—¶å€™åŠæ—¶è·³å‡ºå¾ªç¯
        while (left < right){
// 2. å› ä¸ºæ­¤æ—¶å³è¾¹ç•Œæ­£å¸¸ç¼©å°æ‰€ä»¥ è®© mid = (left+right+1)/2 = right
            int mid = left+(right-left+1>>1);
            if (target == arr[mid]){
                return mid;
            }else if (target > arr[mid]){
/** 1. å·¦è¾¹ç•Œåˆ†å‰²é”™è¯¯ ä¹Ÿå°±æ˜¯è¯´å¦‚æœå‘ç”Ÿï¼š left = ï¼ˆmid = ï¼ˆleft+rightï¼‰/2ï¼‰ å°±ä¼šé™·å…¥æ­»å¾ªç¯,
é‚£ä¹ˆæˆ‘ä»¬è®©å®ƒä¸ç­‰äºå°± Ok äº†,åŒæ—¶è®©å®ƒåœ¨è¾¹ç•Œç›¸ç­‰æ—¶è·³å‡ºå¾ªç¯ */
                left = mid;
            }else if (target < arr[mid]){
                right = mid-1;
            }
        }
// 4. å¯¹æ²¡æ¥çš„åŠè¿›è¡Œæ¯”è¾ƒçš„æ•°æ®ï¼Œè¿›è¡Œè¡¥å……æ¯”è¾ƒ
        return arr[left] == target ? left : -1;
    }
}
```

```java
public class BinarySearch {
    /**
     * right = mid
     * @param arr
     * @param target
     * @return
     */
    public int search(int[] arr, int target){
// 4. å¦‚æœä½ ä¸æƒ³æ‰“ä¸Šéº»çƒ¦çš„è¡¥ä¸ï¼Œright = arr.length è¿™æ ·åœ¨ [leftï¼Œright) çš„æœç´¢åŒºé—´ä¸‹å°±ä¸ä¼šå¿½ç•¥æ‰æœ‰æ•ˆæ•°æ®äº†
        int left = 0, right = arr.length;
// 2. é¿å… left = right æ²¡æœ‰é€€å‡ºå¾ªç¯çš„æƒ…å†µ
        while (left < right){
            int mid = left+(right-left>>1);
            if (target == arr[mid]){
                return mid;
            }else if (target > arr[mid]){
                left = mid+1;
            }else if (target < arr[mid]){
/** 1. å³è¾¹ç•Œåˆ†å‰²é”™è¯¯ ç”±äºå·¦è¾¹ç•Œåˆ†å‰²æ­£å¸¸ï¼ŒåŒæ—¶ å½“ right-left=1 æ—¶ ï¼ˆleft+rightï¼‰/2 = leftï¼Œæ‰€ä»¥å¯èƒ½å‡ºç°çš„é”™è¯¯æƒ…å†µåº”å½“æ˜¯ left = right
ä½†è¿˜æ²¡æœ‰æ‰¾å‡ºç›®æ ‡æ•°æ®è€Œé™·å…¥æ­»å¾ªç¯   */
                right = mid;
            }
        }
// 3. è¡¥ä¸ï¼šæ¯”è¾ƒåœ¨å¾ªç¯ä¸­è¢«å¿½ç•¥çš„æ•°æ®
//        return arr[left] == target ? left : -1;
        return -1;
    }
}
```

```java
public class BinarySearch {
    /**
     * left = mid
     * right = mid
     * @param arr
     * @param target
     * @return
     */
    public int search(int[] arr, int target){
        int left = 0, right = arr.length-1;
// 2. åœ¨ right-left = 1 è¿™ä¸ªå±é™©çš„æ—¶å€™å°½å¿«è·³å‡ºå¾ªç¯
        while (left < right-1){
            int mid = left+(right-left>>1);
            if (target == arr[mid]){
                return mid;
            }else if (target > arr[mid]){
                left = mid;
            }else if (target < arr[mid]){
                right = mid;
            }
        }
/** 1. ç»è¿‡å‰é¢çš„åˆ†æï¼Œæˆ‘ä»¬å‘ç°æ­»å¾ªç¯å‘ç”Ÿçš„æ—¶æœºéƒ½æ˜¯åœ¨ right-left=1 or left = right æ—¶å‘ç”Ÿ
æ‰€ä»¥æˆ‘ä»¬åŠæ—¶åœ¨ä¸¤ç§æƒ…å†µå‘ç”Ÿä¹‹å‰é€€å‡ºï¼Œä»æ ¹æœ¬ä¸Šæ¶ˆé™¤æ­»å¾ªç¯ï¼ˆğŸ˜Šè¿™å°±æ˜¯å‰é¢æåˆ°çš„æŠ€å·§å“¦ğŸ˜œï¼‰ */
        if (arr[left] == target)
            return left;
        else if(arr[right] == target)
            return right;
        else
            return -1;
    }
}
```

å¥½äº†ä¸‰ç§æƒ…å†µç¬”è€…éƒ½å·²ç»åˆ†æå¥½ï¼Œå¹¶ä¸”ç»™å‡ºäº†å‚è€ƒç¨‹åºï¼Œå½“ç„¶è§£æ³•æœ‰å¾ˆå¤šç§å°±çœ‹ä½ æ€ä¹ˆç»„åˆï¼Œåªè¦è§£å†³æˆ‘åˆ—å‡ºçš„ä¸‹åˆ—æƒ…å†µå°± Ok äº†
<center><font color="red" size=4>å¸¸è§é”™è¯¯æ¸…å•</font></center>

| å¸¸è§é”™è¯¯ | å‡ºç°çš„æ—¶æœº |
| --- | --- |
| æœ‰æ•ˆæ•°æ®è¢«å¿½ç•¥æ¯”è¾ƒ | right = length-1ï¼Œ while(left < right) |
| æ•°ç»„è¶Šç•Œè®¿é—® | right = lengthï¼Œwhile(left <= right) `or` right = length-1ï¼Œmid = left + (right-left+1 >> 1)ï¼Œleft = mid-1 |
| æ­»å¾ªç¯ | right - left = 1ï¼Œleft=midï¼Œright=mid |

åŸºæœ¬ä¸Šåªè¦ä½ è§„é¿äº†ä»¥ä¸Šé—®é¢˜ï¼Œå¹¶ä¸”ä¿æŒåŒºé—´æ­£å¸¸ç¼©å°ï¼Œç¨‹åºåº”è¯¥å°±è¶³å¤Ÿ nice äº†ï¼Œ==ä¸è¿‡ä¹Ÿè®¸è¿˜æœ‰ç¬”è€…æ²¡æœ‰é‡åˆ°çš„é—®é¢˜ï¼Œè¯»è€…å¯ä»¥åœ¨ä¸‹æ–¹è¯„è®ºæé†’ç¬”è€…ï¼Œç¬”è€…å°†ä¼šå¯¹æ–°é—®é¢˜æå‡ºè§£å†³æ–¹æ¡ˆï¼Œå¹¶æ›´æ–°æœ¬ç¯‡æ–‡ç« ==ã€‚è‡³äºä¸Šé¢çš„é—®é¢˜è¯¥æ€ä¹ˆè§£å†³ï¼Œç¨‹åºä¸­æˆ‘å·²ç»å†™å‡ºäº†è¯¦ç»†çš„åˆ†æè¿‡ç¨‹ï¼Œå¹¶ç»™å‡ºäº†æµ‹è¯•æ•°æ®ï¼Œå¦‚æœè¯»è€…ä¸ç›¸ä¿¡æˆ‘çš„æµ‹è¯•æ•°æ®ä¹Ÿå¯ä»¥è‡ªè¡Œè®¾è®¡æµ‹è¯•æ•°æ®ã€‚çœ‹åˆ°è¿™æƒ³å¿…ä½ å¯¹è¿™èŠ‚å¼€å¤´æå‡ºçš„é—®é¢˜å·²ç»æœ‰ç­”æ¡ˆäº†å§ï¼

>1. ä¸€å®šè¦è¿™ä¹ˆå†™å—ï¼Ÿ
	å½“ç„¶ä¸æ˜¯
>2. æˆ‘å¯ä»¥éšæ„ç»„åˆå—ï¼Ÿ
	æ˜¯çš„ï¼Œæˆ‘ä»¬å¯ä»¥éšæ„ç»„åˆï¼Œåªè¦è§£å†³æˆ‘ä¸Šé¢æ€»ç»“çš„é”™è¯¯å³å¯
>3. éšæ„ç»„åˆåå¯èƒ½ä¼šå‡ºç°ä»€ä¹ˆé—®é¢˜ï¼Ÿ
	è¯·çœ‹ä¸Šé¢çš„è¡¨æ ¼ã€å¸¸è§é”™è¯¯æ¸…å•ã€‘

## åº”ç”¨åœºæ™¯
é‚£ä¹ˆä¸Šé¢çš„åˆ†æå°±æ˜¯å…¨éƒ¨äº†ï¼Œæ—¢ç„¶è€ƒå‰å¤ä¹ åšå¥½äº†ï¼Œé‚£ä¹ˆå°±è¯¥ä¸Šè€ƒåœºäº†ï¼Œè¯·è¿ç”¨ä½ åˆšåˆšå­¦åˆ°çš„çŸ¥è¯†è§£å†³ä¸‹é¢çš„é—®é¢˜ï¼Œç¬”è€…å°†ä¼šç»™å‡ºå‚è€ƒç¨‹åº
### å¯»æ‰¾å·¦å³ä¾§è¾¹ç•Œ
åŸé¢˜é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/find-first-and-last-position-of-element-in-sorted-array/

`é¢˜ç›®ï¼š`

åœ¨æ’åºæ•°ç»„ä¸­æŸ¥æ‰¾å…ƒç´ çš„ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªä½ç½®

>ç»™å®šä¸€ä¸ªæŒ‰ç…§å‡åºæ’åˆ—çš„æ•´æ•°æ•°ç»„ numsï¼Œå’Œä¸€ä¸ªç›®æ ‡å€¼ targetã€‚æ‰¾å‡ºç»™å®šç›®æ ‡å€¼åœ¨æ•°ç»„ä¸­çš„å¼€å§‹ä½ç½®å’Œç»“æŸä½ç½®ã€‚
å¦‚æœæ•°ç»„ä¸­ä¸å­˜åœ¨ç›®æ ‡å€¼ targetï¼Œè¿”å› [-1, -1]ã€‚

`è¿›é˜¶ï¼š`

ä½ å¯ä»¥è®¾è®¡å¹¶å®ç°æ—¶é—´å¤æ‚åº¦ä¸º O(log n) çš„ç®—æ³•è§£å†³æ­¤é—®é¢˜å—ï¼Ÿ
 
`ç¤ºä¾‹ 1ï¼š`

```
è¾“å…¥ï¼šnums = [5,7,7,8,8,10], target = 8
è¾“å‡ºï¼š[3,4]
```

`ç¤ºä¾‹ 2ï¼š`

```
è¾“å…¥ï¼šnums = [5,7,7,8,8,10], target = 6
è¾“å‡ºï¼š[-1,-1]

```

`ç¤ºä¾‹ 3ï¼š`

```
è¾“å…¥ï¼šnums = [], target = 0
è¾“å‡ºï¼š[-1,-1]
```

`æç¤ºï¼š`

```
0 <= nums.length <= 105
-109 <= nums[i] <= 109
nums æ˜¯ä¸€ä¸ªéé€’å‡æ•°ç»„
-109 <= target <= 109
```

`å‚è€ƒç¨‹åº`

```java
class Solution {
    public int[] searchRange(int[] nums, int target) {
        int[] border = {-1, -1};
// é¿å…æ•°ç»„ä¸ºç©ºæ—¶ï¼Œè¶Šç•Œè®¿é—®äº†
        if (nums.length == 0)
            return border;
// 3. right = nums.lenght é¿å…æ‰“è¡¥ä¸ï¼ˆå¯¹å¿½ç•¥æ•°æ®è¿›è¡Œæ¯”è¾ƒï¼‰
        int left = 0, right = nums.length;
// å¯»æ‰¾å·¦è¾¹ç•Œ

// 2. åœ¨ left = right æ—¶åŠæ—¶è·³å‡ºå¾ªç¯
        while (left < right){
            int mid = left + (right-left>>1);
            if(target == nums[mid]){
/** 1. ç”±äºæˆ‘ä»¬å¯»æ‰¾çš„æ˜¯å·¦è¾¹ç•Œï¼Œæ‰€ä»¥å¹¶ä¸èƒ½ç«‹å³è¿”å›ï¼Œåº”å½“ä¿æŒå½“å‰çš„å€¼ï¼Œå¹¶è®©åŒºé—´å‘å·¦ç¼©å°ï¼Œ
 ä½†åœ¨ right = leftï¼Œnums[right] =  target æ—¶å®šä¼šå‡ºç°æ­»å¾ªç¯ */
                right = mid;
            }else if(target > nums[mid]){
                left = mid+1;
            }else if(target < nums[mid]){
                right = mid-1;
            }
        }
        if(left !=  nums.length)
          border[0] = nums[left] == target ? left : -1;
// å¯»æ‰¾å³è¾¹ç•Œ
        /** æ³¨æ„åˆ«å¿˜è®°é‡æ–°åˆå§‹åŒ– */
        left = 0;
        right = nums.length-1;
// 2. é¿å… right - left = 1 çš„æƒ…å†µ å› ä¸ºè¿™æ ·å®¹æ˜“æ­»å¾ªç¯
        while (left < right-1){
            int mid = left + (right-left>>1);
            if(target == nums[mid]){
/** 1. ç”±äºæˆ‘ä»¬å¯»æ‰¾çš„æ˜¯å³è¾¹ç•Œï¼Œæ‰€ä»¥å¹¶ä¸èƒ½ç«‹å³è¿”å›ï¼Œåº”å½“ä¿æŒå½“å‰çš„å€¼ï¼Œå¹¶è®©åŒºé—´å‘å³ç¼©å°ï¼Œ
 ä½†åœ¨ right = left+1ï¼Œnums[left] = target æˆ–è€… right = leftï¼Œnums[left] = target æ—¶å®šä¼šå‡ºç°æ­»å¾ªç¯ */
                left = mid;
            }else if(target > nums[mid]){
                left = mid+1;
            }else if(target < nums[mid]){
                right = mid-1;
            }
        }
        if(nums[right] == target)
            border[1] = right;
        else if(nums[left] == target)
            border[1] = left;

        return border;
    }
}
```

### åœ¨å•è°ƒé€’å¢åºåˆ—aä¸­ï¼ŒæŸ¥æ‰¾ >= x çš„æ•°ä¸­æœ€å°çš„ä¸€ä¸ªï¼ˆå³xæˆ–xçš„åç»§ï¼‰

```java
public class BinarySearch {
    public int search(int[] a, int x){
        if (a.length == 0)
            return -1;
        int left = 0, right = a.length-1;
// 2. ä¸ºäº†é¿å… left == right æˆ‘ä»¬åº”å½“åœ¨è¿™æ—¶è·³å‡ºå¾ªç¯ æ‰€ä»¥åº”å½“æ˜¯ left < right
        while (left < right){
            int mid = left+(right-left>>1);
            if (x == a[mid]){
/** 1. ç”±äºæˆ‘ä»¬è¦æ‰¾ >= x çš„æœ€å°ä¸€ä¸ªï¼Œä¹Ÿè®¸è¿™ä¸ªå¹¶ä¸æ˜¯æœ€å°çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¹¶ä¸èƒ½ç«‹å³è¿”å›ï¼Œè€Œåº”å½“å‘å·¦ç¼©å°åŒºé—´
ä½†è¿™æ ·å½“ left = right æ—¶ç¨‹åºä¼šè¿›å…¥æ­»å¾ªç¯*/
                right = mid;
            }else if (x > a[mid]){
                left = mid+1;
            }else if (x < a[mid]){
                right = mid;
            }
        }
        if (a[left] >= x)
            return a[left];
        return -1;
    }
}
public class BinarySearchTest {
    public static void main(String[] args) {
        int[] nums = {1, 3, 4, 6, 8, 10};
        int[] target = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11};
        BinarySearch binarySearch = new BinarySearch();
        for (int i=0; i<target.length; ++i){
            System.out.printf("%dçš„åç»§æ˜¯ï¼š%d\n", target[i], binarySearch.search(nums, target[i]));
        }
    }
}
```

æµ‹è¯•ç»“æœï¼š

```java
0çš„åç»§æ˜¯ï¼š1
1çš„åç»§æ˜¯ï¼š1
2çš„åç»§æ˜¯ï¼š3
3çš„åç»§æ˜¯ï¼š3
4çš„åç»§æ˜¯ï¼š4
5çš„åç»§æ˜¯ï¼š6
6çš„åç»§æ˜¯ï¼š6
7çš„åç»§æ˜¯ï¼š8
8çš„åç»§æ˜¯ï¼š8
9çš„åç»§æ˜¯ï¼š10
10çš„åç»§æ˜¯ï¼š10
11çš„åç»§æ˜¯ï¼š-1
```

### åœ¨å•è°ƒé€’å¢åºåˆ—aä¸­ï¼ŒæŸ¥æ‰¾ <= x çš„æ•°ä¸­æœ€å¤§çš„ä¸€ä¸ªï¼ˆå³xæˆ–xçš„å‰é©±ï¼‰

```java
public class BinarySearch {
    public int search(int[] a, int x){
        if (a.length == 0)
            return -1;
        int left = 0, right = a.length-1;
// 3. ä¸ºäº†é¿å… left == right æˆ‘ä»¬åº”å½“åœ¨è¿™æ—¶è·³å‡ºå¾ªç¯ æ‰€ä»¥åº”å½“æ˜¯ left < right
        while (left < right){
// 2. è§£å†³ left = right-1 çš„æ­»å¾ªç¯é—®é¢˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è®© mid != leftï¼Œç­‰äº right å°±è¡Œäº†
            int mid = left+(right-left+1>>1);
            if (x == a[mid]){
/** 1. ç”±äºæˆ‘ä»¬è¦æ‰¾ <= x çš„æœ€å¤§ä¸€ä¸ªï¼Œä¹Ÿè®¸è¿™ä¸ªå¹¶ä¸æ˜¯æœ€å¤§çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¹¶ä¸èƒ½ç«‹å³è¿”å›ï¼Œè€Œåº”å½“å‘å³ç¼©å°åŒºé—´
ä½†è¿™æ ·å½“ left = right or left = right-1 æ—¶ç¨‹åºä¼šè¿›å…¥æ­»å¾ªç¯*/
                left = mid;
            }else if (x > a[mid]){
                left = mid;
            }else if (x < a[mid]){
                right = mid-1;
            }
        }
        if (a[left] <= x)
            return a[left];
        return -1;
    }
}

public class BinarySearchTest {
    public static void main(String[] args) {
        int[] nums = {1, 4, 6, 8, 10};
        int[] target = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11};
        BinarySearch binarySearch = new BinarySearch();
        for (int i=0; i<target.length; ++i){
            System.out.printf("%dçš„å‰é©±æ˜¯ï¼š%d\n", target[i], binarySearch.search(nums, target[i]));
        }
    }
}
```

æµ‹è¯•ç»“æœï¼š

```java
0çš„å‰é©±æ˜¯ï¼š-1
1çš„å‰é©±æ˜¯ï¼š1
2çš„å‰é©±æ˜¯ï¼š1
3çš„å‰é©±æ˜¯ï¼š1
4çš„å‰é©±æ˜¯ï¼š4
5çš„å‰é©±æ˜¯ï¼š4
6çš„å‰é©±æ˜¯ï¼š6
7çš„å‰é©±æ˜¯ï¼š6
8çš„å‰é©±æ˜¯ï¼š8
9çš„å‰é©±æ˜¯ï¼š8
10çš„å‰é©±æ˜¯ï¼š10
11çš„å‰é©±æ˜¯ï¼š10
```

å†æ¬¡æä¸€ä¸‹ä¹‹å‰æè¿‡çš„å°æŠ€å·§ï¼Œå› ä¸ºçœŸçš„å¾ˆæœ‰ç”¨ï¼Œ<font color="red">å¦‚æœå®³æ€•å¤„ç†æ­»å¾ªç¯çš„é—®é¢˜ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨ right-left = 1 æ—¶è·³å‡ºå¾ªç¯ï¼Œè¾¾åˆ°æ¶ˆé™¤æ­»å¾ªç¯çš„ç›®çš„ï¼Œå› ä¸ºç»æ€»ç»“æ­»å¾ªç¯å¾€å¾€åœ¨ right-left = 1 æˆ– right = left ä¹Ÿå°±æ˜¯æœç´¢åŒºé—´åªå‰©ä¸¤ä¸ªæ•°äº¦æˆ–è€…æ˜¯åªå‰©ä¸€ä¸ªæ•°çš„æ—¶å€™å‡ºç°ï¼Œè·³å‡ºå¾ªç¯ä¹‹åä½ å°±å¯ä»¥å¯¹å·¦å³è¾¹ç•Œå•ç‹¬è¿›è¡Œåˆ†æã€‚</font>

## å°¾å£°
é€šå¸¸åªè¦æŒæ¡å…¶ä¸­ä¸€ç§æ ‡å‡†åŒ¹é…å°±å·²ç» OK äº†,æ¯”å¦‚æ–‡ç« å¼€å¤´ç»™å‡ºçš„ demoï¼Œä½†å¦‚æœæƒ³è¦æ·±å…¥äº†è§£äºŒåˆ†æŸ¥æ‰¾ï¼Œæƒ³è¦è½»æ¾è§£å†³äºŒåˆ†æŸ¥æ‰¾çš„å˜å¼é—®é¢˜ï¼Œé‚£ä¹ˆå°±åº”è¯¥å¯¹ä¸åŒå†™æ³•ï¼Œä¸åŒç»„åˆçš„äºŒåˆ†æŸ¥æ‰¾æœ‰è¯¦ç»†çš„äº†è§£ï¼Œç”šè‡³æ˜¯è‡ªå·±èƒ½å¤Ÿéšæ„ç»„åˆï¼Œå°±åƒä¸€ä¸ªé­”æ–¹æ— è®ºå®ƒæ€ä¹ˆæ‰“ä¹±ï¼Œæœ€åéƒ½èƒ½è¿˜åŸ
