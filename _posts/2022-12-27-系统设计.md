---
title: 系统设计
date: 2022-12-27 +/-TTTT
categories: [项目, 商场停车]
tags: []     # TAG names should always be lowercase
---

# 数据实体联系
基于需求分析得到的具体业务，按领域划分为七个小模块，每个模块中划分出相应的实体、事件，如下是关键数据实体-联系图：

1. 会员，车辆，月卡(绑定手机号，录入车辆，开月卡)
2. 车位，闸机(车辆停靠、车辆离开)
3. 积分(签到、兑换)
4. 计费规则(入场、出场)
5. 交易流水(支付、充值)
6. 消息(推送)
7. 洗车

![](https://cdn.jsdelivr.net/gh/Casflawed/img-host@master/blog/202212271652533.png)

# 业务模块设计
按照前面的需求分析，数据实体联系图，设计的微服务模块如下：

- 会员服务，包括会员信息、车辆信息、会员月卡
- 基础资源服务，包括车位、闸机，车辆停靠记录
- 计费服务，车辆出入场记录，计费规则
- 积分服务，积分兑换，会员积分，会员签到得积分
- 财务服务，支付流水，充值流水，财务统计
- 消息服务，记录通知内容
- 洗车服务，积分兑换的洗车券去场内洗车

# 存储设计
微服务架构风格的一个好处，是持久性的封装。我们可以根据每个服务的需要，去选择不同的持久化技术。根据每种数据类型的特点而去选择数据存储的方法，也就是混合持久化，结构化存储与非结构化存储混合使用。不同服务间使用不同的存储模型，单一服务中也可以使用混合存储。既然要采用微服务化结构，从独立开发、运行、部署和运维都是单独的小应用。每个小应用内部业务逻辑处理，到数据库访问，以及数据库都是独立的。

依据本案例的业务场景，我们拆分为七个子存储库，分别为：

- park_member——会员服务库
- park_resource——停车场资源服务库
- park_charging——计费服务库
- park_card——积分服务库
- park_finance——财务服务库
- park_message——消息服务库
- park-carwash——洗车服务库