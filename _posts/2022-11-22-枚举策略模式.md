---
title: 枚举策略模式
date: 2022-11-22 +/-TTTT
categories: [设计模式]
tags: []
---

# 1. 枚举类

## 1.1. 定义

**简单创建一个枚举类**

```java
@Getter
enum WeekdayEnum {
    Monday(1, "星期一"),
    Tuesday(2, "星期二"),
    Wednesday(3, "星期三"),
    Thursday(4, "星期四"),
    Friday(5, "星期五"),
    Saturday(6, "星期六"),
    Sunday(7, "星期天"),
    ;

    private static final HashMap<Integer, WeekdayEnum> enumHashMap = new HashMap<>();
    private final Integer code;
    private final String desc;
    
    static {
        for (WeekdayEnum value : values()) {
            enumHashMap.put(value.getCode(), value);
        }
    }

    WeekdayEnum(Integer code, String desc) {
        this.code = code;
        this.desc = desc;
    }
    
    public static WeekdayEnum getEnumByCode(Integer code){
        return enumHashMap.get(code);
    }

}
```

该枚举类穷举了一周内的所有天，并建立了一个基于 HashMap 的本地缓存，通过缓存向外界提供了 getEnumByCode()，即通过 code 获取对应的枚举。当类的对象是有限的，该类适合定义成枚举类。

**枚举类的特性**

反编译 WeekdayEnum.class 能得到下面的结果：

```java
import java.util.HashMap;

final class WeekdayEnum extends Enum{

    public static WeekdayEnum[] values(){
        return (WeekdayEnum[])$VALUES.clone();
    }
    public static WeekdayEnum valueOf(String name){
        return (WeekdayEnum)Enum.valueOf(enums/WeekdayEnum, name);
    }
    private WeekdayEnum(String s, int i, Integer code, String desc){
        super(s, i);
        this.code = code;
        this.desc = desc;
    }
    public static WeekdayEnum getEnumByCode(Integer code){
        return (WeekdayEnum)enumHashMap.get(code);
    }
    public Integer getCode(){
        return code;
    }
    public String getDesc(){
        return desc;
    }
    public static final WeekdayEnum Monday;
    public static final WeekdayEnum Tuesday;
    public static final WeekdayEnum Wednesday;
    public static final WeekdayEnum Thursday;
    public static final WeekdayEnum Friday;
    public static final WeekdayEnum Saturday;
    public static final WeekdayEnum Sunday;
    private static final HashMap enumHashMap;
    private final Integer code;
    private final String desc;
    private static final WeekdayEnum $VALUES[];

    static {
        Monday = new WeekdayEnum("Monday", 0, Integer.valueOf(1), "\u661F\u671F\u4E00");
        Tuesday = new WeekdayEnum("Tuesday", 1, Integer.valueOf(2), "\u661F\u671F\u4E8C");
        Wednesday = new WeekdayEnum("Wednesday", 2, Integer.valueOf(3), "\u661F\u671F\u4E09");
        Thursday = new WeekdayEnum("Thursday", 3, Integer.valueOf(4), "\u661F\u671F\u56DB");
        Friday = new WeekdayEnum("Friday", 4, Integer.valueOf(5), "\u661F\u671F\u4E94");
        Saturday = new WeekdayEnum("Saturday", 5, Integer.valueOf(6), "\u661F\u671F\u516D");
        Sunday = new WeekdayEnum("Sunday", 6, Integer.valueOf(7), "\u661F\u671F\u5929");
        $VALUES = (new WeekdayEnum[] {
            Monday, Tuesday, Wednesday, Thursday, Friday, Saturday, Sunday
        });
        enumHashMap = new HashMap();
        WeekdayEnum aweekdayenum[] = values();
        int i = aweekdayenum.length;
        for(int j = 0; j < i; j++){
            WeekdayEnum value = aweekdayenum[j];
            enumHashMap.put(value.getCode(), value);
        }

    }
}
```

通过这段反编译代码，我们发现编译器为我们做了这些事情：

1. 枚举类是一个被 final 修饰的普通类，即它无法被继承。
2. 构造函数新增两个参数，String 类型的 s，和 int 类型的 i，分别是枚举对象的变量名和排序值（从 0 开始）
3. 新增一个 valueOf()，即通过变量名获取枚举对象
4. 新定义了一个枚举数组 $VALUES 缓存所有的枚举，以及一个返回数组拷贝的 values()

以上便是编译器为定义的枚举类额外做的事，我们发现枚举类就是一个普通的类，并且如果只有一个枚举对象，那么它其实就是一个单例模式的实现。


## 1.3. 枚举类和常量类
还是以星期这个场景简单设计一个常量类，如下：

```java
public class WeekdayConstant {
    public static final Integer MONDAY = 1;
    public static final Integer TUESDAY = 2;
    public static final Integer WEDNESDAY = 3;
    public static final Integer THURSDAY = 4;
    public static final Integer FRIDAY = 5;
    public static final Integer SATURDAY = 6;
    public static final Integer SUNDAY = 7;
}
```

先不说相关特性和使用场景，常量类相比枚举类的设计要简单许多。


**在相同场景使用**

如：绑定状态码（code）和响应消息（message），推荐使用枚举类进行控制，如果使用常量类，一旦常量过多维护困难，同时容易插入重复的常量。当然如果系统要求不高，那么采用常量类会要简单很多


## 1.4. 枚举类与前端

## 1.5. 枚举类与数据库

# 2. 经典策略模式和枚举策略模式

## 2.2. 策略模式常见应用场景

**快递**

**排行榜**

**会员制度**

## 2.1. 枚举策略模式和经典策略模式
下面以会员制度为例分别展示两种模式的不同写法：

**经典策略模式**



**枚举策略模式**



## 2.3. 为什么不推荐经典策略模式

**枚举策略模式实践**
 
